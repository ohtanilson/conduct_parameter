\documentclass[11pt, a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,setspace,geometry}
\usepackage{amsfonts}
\usepackage[shortlabels]{enumitem}
%\usepackage[dvipdfmx]{hyperref,graphicx}
\usepackage{graphicx}
\usepackage{bbm}
\usepackage[dvipsnames]{xcolor}
\usepackage[colorlinks=true, linkcolor= BrickRed, citecolor = BrickRed, filecolor = BrickRed, urlcolor = BrickRed, hypertexnames = true]{hyperref}
\usepackage[]{natbib} 
\bibpunct[:]{(}{)}{,}{a}{}{,}
\geometry{left = 1.0in,right = 1.0in,top = 1.0in,bottom = 1.0in}
%\onehalfspacing
% \usepackage{setspace}
%\doublespacing
%\renewcommand{\baselinestretch}{0.3}
\usepackage[english]{babel}
\usepackage{float}
\usepackage{subfig}
\usepackage{booktabs}
\usepackage{pdfpages}
\usepackage{threeparttable}
\usepackage{lscape}
\usepackage{bm}
\setstretch{1.4}



\newtheorem{theorem}{Theorem}
\newtheorem{assumption}{Assumption}
\newtheorem{lemma}{Lemma}
\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}
\newtheorem{claim}{Claim}
\newtheorem{corollary}{Corollary}
\newtheorem{example}{Example}

\title{Conduct Parameter Project}
\author{Yuri Matsumura \and Suguru Otani \footnote{Department of Economics, Rice University.}}

\begin{document}

\maketitle

\begin{abstract}
    We revisit the conduct parameter estimation in homogenous goods market. In contrast to the pessimistic simulation results shown in \cite{perloff2012collinearity}, our simulation shows that the estimation becomes accurate by properly adding demand shifters in the supply estimation and increasing the sample size. However, we show that the standard estimation procedure is sensitive to the data generating process (DGP) widely used in Industrial Organization literature. As a remedy, we propose MPEC approach \citep{su2012constrained,dube2012improving} for simultaneous equation GMM with inequality constraint and show its robustness to the DGP.
\end{abstract}

\section{Introduction}
%主題%
Measuring competitiveness in markets is one of the important tasks in Empirical Industrial Organization literature.
Markup is regarded as a useful measure of competitiveness. 
However, markup cannot be measured directly from data because data usually lack information about marginal cost.
Therefore, the researchers have tried to estimate the markup in markets.

% Conduct parameter estimationを何とつなげて書くべきか？ Market powerと絡めるのか，market strucutureなのか？


The literature has considered two types of models.

%現状 - 1%
The first one is the model with linear demand and linear marginal cost.
\citet{bresnahan1982oligopoly} considers the identification of conduct parameter in this model.
However, \citet{perloff2012collinearity} shows that the model in \citet{bresnahan1982oligopoly} is suffered from the multicollinear problem when the error terms in the demand and supply equations are zero and claims that the model parameters can not be estimated.
While the situation where the multicollinearity problem arises hardly happens not only in simulation studies but also in practice, the paper still claims that the near collinearity problem contaminates the estimation.
Then by conducting Monte Carlo simulations, the parameter shows that the marginal cost parameters and the conduct parameter can not be estimated accurately.
To avoid the multicollinearity problem and nearly perfect collinearity problem, the paper recommends using log-linear or some other functional form for at least one of the equations.
%問題 -1%
However, the simulation in \cite{perloff2012collinearity} has some problems.
First, the estimation of the supply equation lacks the excluded demand shifter.
Second, it does not check the effect of increasing the sample size.


%現状 - 2%
The second model is the model with log demand and log marginal cost.
The identification strategy is provided by \citet{lau1982identifying}.
%問題 - 2%
\cite{hyde1995can} conduct a simulation of the model, but the paper does not show the simulation result but shows the result of hypothesis tests based on the simulation result.
Furthermore, it still has the same problem in the \cite{perloff2012collinearity} because it lacks the demand shifter in the supply-side estimation.




%結果%
To check the accuracy of the estimation of models with the conduct parameter, we reexamine the simulation model in \cite{perloff2012collinearity} and \cite{perloff2012collinearity}.
First, our simulation successfully replicates the result in \cite{perloff2012collinearity}.
Then our simulation results confirm that the accuracy of the estimation is improved by including a demand shifter in the supply equation estimation.
Given the standard deviation of the error terms, when the sample size is more than 100, the accuracy of the estimation is also improved.

Next, we conduct the simulation of the model with log demand and log marginal cost...


The rest of the paper ...



\section{Model}
The researcher has data with $T$ markets with homogeneous products.
Assume that there are $N_t$ firms in each market.
Let $t = 1,\ldots, T$ be the index of markets and $j = 1, \ldots, N_t$ be the index of firms in market $t$.
Firm $j$ solves a profit maximization problem such that
\begin{align}
    \max_{q_{jt}} \ \pi_{jt}(q_{jt}, q_{-jt}) \equiv (P(Q_t) - mc_{jt}(q_{jt}))q_{jt},
\end{align}
where $Q_t = \sum_{j = 1}^{N_t} q_{jt}$ is the aggregate quantity, $P(Q_t)$ the inverse demand function, and $mc_{jt}(q_{jt})$ the marginal cost function.
From the maximization problem, we obtain the first-order condition,
\begin{align}
    0 = P(Q_{t}) - mc_{jt}(q_{jt}) + \theta_i P'(Q_{t})q_{jt},
\end{align}
where $\theta_{it} = 1 + \sum_{k\ne j}\frac{\partial q_{kt}}{\partial q_{jt}}$, which is called conduct parameter.
By summing up the first-order condition across firms, we obtain the supply equation 
\begin{align}
     P_t = -\theta_{it}P'(Q_{t})Q_t + MC_t(Q_t)
\end{align}
where $\theta_t = \frac{1}{N_t}\sum_{i = 1}^{N_t}\theta_{it}$ and $MC_t(Q_t) = \frac{1}{N_t}\sum_{j = 1}^{N_t} mc_{jt}(q_{jt})$.

Let's consider an econometric model of the quantity competition.
Assume that the demand function and the marginal cost function are written as 
\begin{align}
    P_t = f(Q_t, Y_t, \varepsilon_{dt}, \alpha)\\
    MC_t = g(Q_t, W_t, \varepsilon_{ct}, \beta)
\end{align}
where $Y_t$ and $W_t$ are the vector of exogenous variables, $\varepsilon_{dt}$ and $\varepsilon_{ct}$ the error terms, and $\alpha$ and $\beta$ are the vector of parameters
We also have the vector of the demand-side instrument variables $Z_{dt}$ and the vector of the supply-side instrument variables $Z_{ct}$.
Then we assume that the error terms satisfy the mean independence condition $E[\varepsilon_{dt}\mid Y_t, Z_{dt}] = E[\varepsilon_{ct} \mid W_t, Z_{ct}] =0$.


\section{Identification of the conduct parameter}
The identification of the conduct parameter in a linear model is considered by \cite{bresnahan1982oligopoly} and the identification in a general model which includes the log model is considered by \cite{lau1982identifying}.
Here we review the identification in \cite{bresnahan1982oligopoly} to see the importance of an instrument variable called the demand rotation IV.

Assume that the demand function and the marginal cost function are linear
\begin{align}
    P_{t}=\alpha_0 - \alpha_1 Q_{t} + \alpha_2 Y_t + \varepsilon_{dt},\\
    MC_{t} = \gamma_0 + \gamma_1 Q_t + \gamma_3 W_t + \varepsilon_{ct}.
\end{align}
As we have the demand-side instruments $Z_{dt}$, we can identify the parameters in the demand equation easily and regard the value of the parameters as given.
Now consider the identification of the parameter in the supply equation.
By substituting $P_t'= - \alpha_1$ into the supply equation, we obtain
\begin{align}
    P_{t}&=\gamma_0+\gamma_1 Q_t + \theta\alpha_1 Q_t + \gamma_3 Y_t + \varepsilon_{ct} =\gamma_0+\left(\gamma_1- \theta\alpha_1\right) Q_t + \gamma_3 Y_t + \varepsilon_{ct} 
\end{align}
Then, the value of $(\gamma_1- \theta\alpha_1)$ is identified, but $\theta$ and $\gamma_1$ cannot be identified separately.

\cite{bresnahan1982oligopoly} provides the trick to identify $\theta$. 
Assume that the inverse demand is given as 
\begin{align}
    P_{t}=\alpha_0 - (\alpha_1+\alpha_2 Z^R_t) Q_{t} + \alpha_3 Y_t + \varepsilon_{dt},
\end{align}
where $Z^R_t$ is called demand rotation IV.
Again, the demand parameters are identified.
By substituting $\partial P_t/\partial Q_t = -(\alpha_1+\alpha_2 Z^R_t)$ into the supply equation, we obtain
\begin{align}
    P_{t}&=\gamma_0+\gamma_1 Q_t + \theta (\alpha_1+\alpha_2 Z^R_t) Q_t + \gamma_3 W_t + \varepsilon_{ct} \\
    &= \gamma_0 + (\gamma_1 + \theta \alpha_1) Q_t + \theta\alpha_1 Z^R_tQ_t + \gamma_3 W_t + \varepsilon_{ct}  
\end{align}
Since $\alpha_1$ and $\alpha_2$ are identified from the demand equation and $(\gamma_1 - \theta\alpha_1)$ and $\theta \alpha_1$ are identified, we can identify $\theta$ and $\gamma_1$ separately.



\section{Simulation Setting}

\subsection{Linear demand and linear cost}
Assume that a linear demand function and a linear marginal cost function such that
\begin{align}
    P_t = \alpha_0 - (\alpha_1 + \alpha_2Z^R_t)Q_t + \alpha_3 Y_t + \varepsilon_{dt},\\
    MC_t = \gamma_0  + \gamma_1 Q + \gamma_2 w_t + \gamma_3 r_t + \varepsilon_{ct},
\end{align}
where $w_t$ and $r_t$ are excluded cost shifter.
The supply equation is given as
\begin{align}
    P_t = \gamma_0 + [\theta(\alpha_1 + \alpha_2Z^R_t)+ \gamma_1] Q_t   + \gamma_2 w_t + \gamma_3 r_t + \varepsilon_{ct}
\end{align}
From the supply equation and the demand equation, we can represent the aggregate quantity $Q_t$ based on the parameters and the exogenous variables as   
\begin{align}
    Q_t =  \frac{\alpha_0 + \alpha_3 Y_t - \gamma_0 - \gamma_2 w_t - \gamma_3 r_t + \varepsilon_{dt} - \varepsilon_{ct}}{(1 + \theta) (\alpha_1 + \alpha_2Z^R_t) + \gamma_1}.
\end{align}

Assume that the exogenous and instrument variables are drawn from normal distributions; $ Y_t \sim N(0,1)$, $w_t \sim N (3, 1)$, $r_t \sim N (0, 1)$, $ Z^R_t \sim N (10, 1)$.
As additional instruments, two random variables are created by adding an additional random variable drawn from the standard normal distribution to $w_t$ and $r_t$, which is denoted by $h_t$ and $k_t$.
The value of the conduct parameter is $\theta = 0.5$, the value of the constant term in the demand equation is $\alpha_0 = 10$, and the value of the rest of the parameters is one; $\alpha_1 = \alpha_2 = \alpha_3 = \gamma_0 = \gamma_1 = \gamma_2  = \gamma_3 = 1$. 
The error terms follow the normal distribution with mean zero and with standard deviation $\sigma$; $\varepsilon_{ct}\sim N(0,\sigma)$, $\varepsilon_{dt} \sim N(0,\sigma)$.
We change the value of $\sigma$ to see how the variation of the error terms affects the accuracy of the estimation.

Note that while the aggregate quantity is changed by the change in $Y_t$ as $\alpha_3 =1$, \cite{perloff2012collinearity} assumes $\alpha_3 = 0$, that is, their simulation ignores the exogenous variable $Y_t$.
However, we don't have any exogenous demand shifter to estimate the supply equation in that case.
Our results emphasize the role of the exogenous demand shifter in the estimation of the supply equation.



\subsubsection{Estimation}
%To estimate the parameters in the demand equation and the supply equation, \cite{perloff2012collinearity} applies the 2SLS, the 3SLS, and the nonlinear 3SLS.
%Since \cite{perloff2012collinearity} only shows the results based on the 2SLS and the 3SLS, we also focus on these estimation methods.

We separately apply the 2SLS to each equation.
The instrument variables for the demand estimation are $Z_{dt} = (Z^R_t, Y_t, h_t, k_t)$.
The instrument variables for the supply estimation are $Z_{ct} = (Z^R_t, w_t, r_t, Y_t)$. 
To see the role of the demand shifter $Y_t$, we show the estimation results with and without $Y_t$.

To conduct the simulation, we generate 1000 data sets by using R and estimate the equations by using the \texttt{ivreg} package in R.
Note that an important feature of the model is that we have an interaction term of the endogenous variable $Q_t$ and the instrument variable $Z^R_t$.
The \texttt{ivreg} package automatically detects that the endogenous variables are $Q_t$ and the interaction term $Z^R_tQ_t$ and runs the first stage regression for each endogenous variable by using the same instruments.\footnote{To confirm this, we manually wrote R code that implements the 2SLS. When the first stage includes only the regression of $Q_t$, the estimation results from our code differ from the results from \texttt{ivreg}. But when we modified the code so that regress $Z^R_tQ_t$ on the instrument variables and estimate the second stage by using the predicted values of $Q_t$ and $Z^R_tQ_t$, the result from our code and the result from \texttt{ivreg} coincided.}


\subsection{Log demand and log marginal cost}

Considers a model with log demand and a Cobb-Douglas cost function. 
The demand equation is given as a log-demand, 
\begin{align}
    \log P_{t} = \alpha_0 - (\alpha_1 + \alpha_2 Z^R_t) \log Q_t + \alpha_3 \log Y_t + \varepsilon_{dt}.
\end{align}
The log marginal cost is given as 
\footnote{\cite{hyde1995can} consider a Cobb-Douglas cost function such that \begin{align*}
    C_t = A^{-1/\gamma} \gamma \left(\frac{w_t}{\alpha}\right)^{\frac{\alpha}{\gamma}} \left(\frac{r_t}{\beta}\right)^{\frac{\beta}{\gamma}} Q_t^{\frac{1}{\gamma}}e^{\varepsilon_{ct}},
\end{align*} where $\alpha + \beta = \gamma$, and derive the log marginal cost function.}
\begin{align}
    \log MC_t &= \gamma_0 + \gamma_1 \log Q_t +  \gamma_2 \log w_t + \gamma_3 \log r_t + \varepsilon_{ct}.
\end{align}
Since $P'(Q) = - (\alpha_1 + \alpha_2 Z^R) \frac{P}{Q} $, the supply equation is given as
\begin{align}
    P_t &= \theta_t (\alpha_1 + \alpha_2 Z^R_t) \frac{P_t}{Q_t} Q_t + mc_t,
\end{align}
and by taking logarithm, we obtain
\begin{align}
    \log P_t & = - \log(1 - \theta(\alpha_1 + \alpha_2 Z^R_t)) + \gamma_0 + \gamma_1 \log Q_t +  \gamma_2 \log w_t + \gamma_3 \log r_t + \varepsilon_{ct}
\end{align}
From the supply equation and the demand equation, the log aggregate quantity is given as 
\begin{align}
    \log Q_t &= \frac{ \alpha_0 + \alpha_3 \log Y_t + \log (1 - \theta (\alpha_1 + \alpha_2 Z^R_t)) - \gamma_0  -  \gamma_2 \log w_t - \gamma_3 \log r_t + \varepsilon_{dt} - \varepsilon_{ct}}{\gamma_1+ \alpha_1 + \alpha_2 Z^R_t }.
\end{align}

Assume that the exogenous in the cost side and instrument variables are drawn from uniform distributions; $w \sim U(1,3)$,$r \sim U(0,1)$, and $Z \sim U(5, 10)$. The demand shifter $Y_t$ is drawn from the standard normal distribution.
The error term are drawn from a normal distribution with mean zero and standard deviation $\sigma$; $\varepsilon_{ct}\sim N(0,\sigma)$, $\varepsilon_{dt} \sim N(0,\sigma)$.
We use the same parameter values in the linear model.






\subsubsection{Estimation in Hyde and Perloff (1995)}
The demand and supply equations are
\begin{align}
    &\log P_{t} = \alpha_0 - \alpha_1 \log Q_t - \alpha_2 Z^R_t\log Q_t + \alpha_3 \log Y_t + \varepsilon_{dt},\\
    &\log P_t  = - \log(1 - \theta(\alpha_1 + \alpha_2 Z^R_t)) + \gamma_0 + \gamma_1 \log Q_t +  \gamma_2 \log w_t + \gamma_3 \log r_t + \varepsilon_{ct}.
\end{align}
As we can immediately see, the supply equation is a nonlinear equation.
We assume two moment conditions $E[Z_{dt} \varepsilon_{dt}] = \bm0 $ and $ E[Z_{st} \varepsilon_{st}] =\bm0$ where $Z_{dt}$ is the vector of instruments for the demand equation and $Z_{st}$ the vector of instruments for the supply equation.
Based on the moment conditions, we can apply the generalized method of moments.
We consider two estimators; the nonlinear system 2SLS estimator and the nonlinear 3SLS estimator.\footnote{See Wooldridge (2010), Ch 14.}



\section{Results}


\subsection{The linear demand and linear marginal cost model}
Table \ref{tb:linear_linear_sigma_Perloff_Shen} is quoted from \cite{perloff2012collinearity}.
It shows that the demand estimation becomes accurate as the value of $\sigma$ decreases.
In contrast, the supply-side estimation is still biased and the standard deviation of the conduct parameter becomes larger as the value of $\sigma$ increases.

Table \ref{tb:linear_linear_sigma_1_without_demand_shifter_y} shows our 2SLS estimation results without the demand shifter. 
This result uses the same simulation setting with \citet{perloff2012collinearity}.
The results show that while the demand parameter can be accurately estimated even though the value of $\sigma$ becomes larger, the supply side parameter is biased.
Especially, when $\sigma$ is large and the sample size is small, the standard deviation of the parameters in the supply-side equation becomes large.
Thus we can correctly replicate the result in \citet{perloff2012collinearity}.
Unlike in \cite{perloff2012collinearity}, we also change the sample size.
As it is expected, the increase in the sample size given a value of $\sigma$ improves the standard deviation of the parameter in the supply equation. 
But no estimation result can find the true values of the parameter.

Next, Table \ref{tb:linear_linear_sigma_1} shows the 2SLS estimation results with the demand shifter.
When $\sigma = 0.001$, Panel (a) shows that the estimation of all parameters is quite accurate.
Especially, when the sample size is large, the standard deviations of all parameters are less than 0.001.
When $\sigma = 2$ and $n = 50$, Panel (d) shows that the supply-side estimation is biased.
The value of $\gamma_1$, the coefficient  of $Q_t$ in the supply equation, is far from the true value $\gamma_1 = 1$ and the standard deviation is much larger than the standard deviation in the model without $Y_t$.
But as the increase in the sample size dramatically improves the standard deviation, and when the sample size is $n = 1000$, all parameters are estimated more accurately than the result in the model without $Y_t$.





\subsection{Log demand and log marginal cost}


\paragraph{Yuri Julia}
\begin{itemize}
    \item $w \sim U(1,3)$,$r \sim U(0,1)$, and $Z \sim U(0, 1)$. The demand shifter $Y_t$ is drawn from the standard normal distribution
    \item Two additional random variables are created by adding a random variable drawn from the standard normal distribution to $w$ and $r$
\end{itemize}



\paragraph{Suguru R}
\begin{itemize}
    \item $w\sim U(1,3) $, $r\sim U(0,1) $, $y\sim N(0,1) $, $z\sim U(0,1) $, $iv_{w}=w+N(0,1) $, $iv_{r}=r+N(0,1) $
    \item $\theta=0.3$ and $\alpha_2=0.1$ and other parameters are the same as linear case
\end{itemize}

\section{MPEC for constrained GMM}

\begin{itemize}
    \item separate
    \item separate, [0,1]constraint
    \item separate, logconstraint
    \item separate, [0,1]constraint,logconstraint
\end{itemize}

    
\section{Conclusion}

XXX

\appendix


\begin{table}[!htbp]
    \centering
    \caption{Estimation results in Table 2 of from \cite{perloff2012collinearity}}
    \label{tb:linear_linear_sigma_Perloff_Shen} 
        \begin{tabular}{cllll}
            \hline\hline
            & $\sigma=0.001$ & $\sigma=0.5$ & $\sigma=1$ & $\sigma=2$ \\
            $\alpha_0$ & $10.00(0.001)$ & $9.96(0.33)$ & $9.86(0.65)$ & $9.46(1.20)$ \\
            $\alpha_1$ & $1.00(0.004)$ & $0.99(1.98)$ & $0.97(3.96)$ & $0.88(7.80)$ \\
            $\alpha_2$ & $1.00(0.004)$ & $0.99(0.21)$ & $0.97(0.42)$ & $0.87(0.82)$ \\
            $\gamma_1$ & $0.46(0.88)$ & $0.46(0.91)$ & $0.47(0.93)$ & $0.49(1.04)$ \\
            $\gamma_2$ & $5.85(7.89)$ & $5.85(8.15)$ & $5.78(8.21)$ & $5.73(8.66)$ \\
            $\theta$ & $-0.31(1.31)$ & $-0.29(1.34)$ & $0.09(11.48)$ & $-1.53(30.41)$ \\
            \hline
        \end{tabular}
\end{table}


\begin{table}[!htbp]
  \begin{center}
      \caption{Estimation results without demand shifter}
      \label{tb:linear_linear_sigma_1_without_demand_shifter_y} 
      \subfloat[$\sigma=0.001$]{\input{figuretable/linear_linear_sigma_0.001_without_demand_shifter_y}}\\
      \subfloat[$\sigma=0.5$]{\input{figuretable/linear_linear_sigma_0.5_without_demand_shifter_y}}\\
      \subfloat[$\sigma=1.0$]{\input{figuretable/linear_linear_sigma_1_without_demand_shifter_y}}\\
    \subfloat[$\sigma=2.0$]{\input{figuretable/linear_linear_sigma_2_without_demand_shifter_y}}
  \end{center}\footnotesize
  Note: True parameters: $\alpha_1 = \alpha_2 =  \gamma_0 = \gamma_1 = \gamma_2  =  1, \alpha_0 = 10, \theta = 0.5.$ and $\alpha_3 =0$
\end{table} 


\begin{table}[!htbp]
  \begin{center}
      \caption{Estimation results with demand shifter}
      \label{tb:linear_linear_sigma_1} 
      \subfloat[$\sigma=0.001$]{\input{figuretable/linear_linear_sigma_0.001}}\\
      \subfloat[$\sigma=0.5$]{\input{figuretable/linear_linear_sigma_0.5}}\\
      %\subfloat[$\sigma=1.0$]{\input{figuretable/linear_linear_sigma_1}}\\
    \subfloat[$\sigma=2.0$]{\input{figuretable/linear_linear_sigma_2}}
  \end{center}\footnotesize
  Note: True parameters: $\alpha_1 = \alpha_2 = \alpha_3 = \gamma_0 = \gamma_1 = \gamma_2  = \gamma_3 = 1, \alpha_0 = 10, \theta = 0.5.$
\end{table} 


\begin{table}[!htbp]
  \begin{center}
      \caption{Estimation results with demand shifter (Log linear)}
      \label{tb:loglinear_loglinear_sigma_1} 
      \subfloat[$\sigma=0.001$]{\input{figuretable/loglinear_loglinear_sigma_0.001}}\\
      \subfloat[$\sigma=0.5$]{\input{figuretable/loglinear_loglinear_sigma_0.5}}\\
      %\subfloat[$\sigma=1.0$]{\input{figuretable/loglinear_loglinear_sigma_1}}\\
    \subfloat[$\sigma=2.0$]{\input{figuretable/loglinear_loglinear_sigma_2}}
  \end{center}\footnotesize
  Note: True parameters: $\alpha_1 = \alpha_3 = \gamma_0 = \gamma_1 = \gamma_2  = \gamma_3 = 1, \alpha_0 = 10, \alpha_2 = 0.1,  \theta = 0.3.$
\end{table} 







\bibliographystyle{aer}

\bibliography{conduct_parameter}

\end{document}