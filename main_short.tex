\documentclass[11pt, a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,setspace,geometry}
\usepackage{amsfonts}
\usepackage[shortlabels]{enumitem}
\usepackage{rotating}
\usepackage{pdflscape}
\usepackage{graphicx}
\usepackage{bbm}
\usepackage[dvipsnames]{xcolor}
\usepackage[colorlinks=true, linkcolor= BrickRed, citecolor = BrickRed, filecolor = BrickRed, urlcolor = BrickRed, hypertexnames = true]{hyperref}
\usepackage[]{natbib} 
\bibpunct[:]{(}{)}{,}{a}{}{,}
\geometry{left = 1.0in,right = 1.0in,top = 1.0in,bottom = 1.0in}
\usepackage[english]{babel}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{pdfpages}
\usepackage{threeparttable}
\usepackage{lscape}
\usepackage{bm}
\setstretch{1.4}
%\usepackage[tablesfirst,nolists]{endfloat}


\newtheorem{theorem}{Theorem}
\newtheorem{assumption}{Assumption}
\newtheorem{lemma}{Lemma}
\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}
\newtheorem{claim}{Claim}
\newtheorem{corollary}{Corollary}
\newtheorem{example}{Example}

\title{Revisiting Conduct Parameter Estimation in Homogeneous Goods Markets: At Least, Linear Model is Valid}
\author{Yuri Matsumura\footnote{Department of Economics, Rice University. Matsumura: \texttt{\href{mailto:Yuri.Matsumura@rice.edu}{Yuri.Matsumura@rice.edu}}} \and Suguru Otani \footnote{Department of Economics, Rice University. Otani: \texttt{\href{mailto:so19@rice.edu}{so19@rice.edu}}\\
Declarations of interest: none}}

\begin{document}

\maketitle

\begin{abstract}
    We revisit the conduct parameter estimation in homogeneous goods markets. In contrast to the pessimistic simulation results of linear models shown in \cite{perloff2012collinearity}, our simulation shows that the estimation becomes accurate by properly adding demand shifters in the supply estimation and increasing the sample size. We also investigate log-linear models widely used in Industrial Organization literature and recommended by \cite{perloff2012collinearity} and find other estimation problems. Based on the numerical investigation, at least the linear model can achieve a proper estimation of the conduct parameter.
\end{abstract}
% 84words

\section{Introduction}

Measuring competitiveness is one of the important tasks in Empirical Industrial Organization literature.
Conduct parameter is regarded as a useful measure of competitiveness. 
However, it cannot be measured directly from data because data usually lack information about marginal cost.
Therefore, the researchers have tried to identify and estimate the conduct parameter.

The literature has considered two popular specifications of the model for conduct parameter estimation in homogeneous good markets; one is the model with linear demand and marginal cost and the other is the model with log-linear demand and marginal cost.

As for the linear model, \citet{bresnahan1982oligopoly} considers the identification of conduct parameter. 
\citet{perloff2012collinearity} (hereafter, PS) theoretically show that the model is suffering from the multicollinearity problem when the error terms in the demand and supply equations are zero and show by simulations that the parameters cannot be estimated accurately even when the error terms are not zero.
To avoid the problems, the paper recommends using log-linear or some other functional form for at least one of the equations.
As for the log-linear model, the identification strategy is provided by \citet{lau1982identifying}. 
The specification is often used in empirical papers such as \cite{okazaki2022excess} and \cite{merel2009measuring}.

We find the following problems.
As for the linear model, the simulation in PS lacks an excluded demand shifter in the supply equation estimation. 
Also, the paper does not check the effect of increasing the sample size. 
As for the log-linear model, to the best of our knowledge, there is no simulation study to justify the claim of PS.

Given these problems, we revisit the estimation of the conduct parameter in homogeneous product markets.
We confirm that the accuracy of the estimation holds by including a demand shifter in the supply equation estimation properly. 
When the sample size is more than 100, the accuracy of the estimation is also improved.

Next, we examine the log-linear model and numerically show that standard regression estimates an incorrect conduct parameter because the specification adds other estimation problems.
Thus, we conclude that at least the linear model is a valid specification for the conduct parameter estimation in homogeneous good markets.

% 366 words by Suguru


\section{Model}
The researcher has data with $T$ markets with homogeneous products.
Assume that there are $N$ firms in each market.
Let $t = 1,\ldots, T$ be the index of markets.
Then, we obtain the supply equation:
\begin{align}
     P_t = -\theta\frac{\partial P_t(Q_t)}{\partial Q_t}Q_t + MC_t(Q_t),\label{eq:supply_equation}
\end{align}
where $Q_t$ is the aggregate quantity, $P_t(Q_{t})$ the demand function, $MC_{t}(Q_{t})$ the marginal cost function, and $\theta\in[0,1]$ which is called conduct parameter. 
The equation nests perfect competition, $\theta=0$, Cournot competition, $\theta=1/N, N$ firm symmetric perfect collusion, $\theta=1$, etc.\footnote{See \cite{bresnahan1982oligopoly}.} 

Consider an econometric model of the above model.
Assume that the demand function and the marginal cost function are written as: 
\begin{align}
    P_t = f(Q_t, Y_t, \varepsilon^{d}_{t}, \alpha) \label{eq:demand}\\
    MC_t = g(Q_t, W_{t}, \varepsilon^{c}_{t}, \gamma)\label{eq:marginal_cost}
\end{align}
where $Y_t$ and $W_{t}$ are the vector of exogenous variables, $\varepsilon^{d}_{t}$ and $\varepsilon^{c}_{t}$ the error terms, and $\alpha$ and $\gamma$ are the vector of parameters.
We also have the demand- and supply-side instrument variables $Z^{d}_{t}$ and $Z^{c}_{t}$ and assume that the error terms satisfy the mean independence condition $E[\varepsilon^{d}_{t}\mid Y_t, Z^{d}_{t}] = E[\varepsilon^{c}_{t} \mid W_{t}, Z^{c}_{t}] =0$.

%254 words by Suguru

\section{Linear model and log-linear model}

\subsection{Linear demand and linear cost}
Assume that linear demand and cost functions are specified as:
\begin{align}
    P_t &= \alpha_0 - (\alpha_1 + \alpha_2Z^{R}_{t})Q_t + \alpha_3 Y_t + \varepsilon^{d}_{t},\label{eq:linear_demand}\\
    MC_t &= \gamma_0  + \gamma_1 Q_{t} + \gamma_2 W_{t} + \gamma_3 R_t + \varepsilon^{c}_{t},\label{eq:linear_marginal_cost}
\end{align}
where $W_{t}$ and $R_t$ are excluded cost shifters and $Z^{R}_{t}$ is Bresnahan's demand rotation instrument. 
Equation \eqref{eq:supply_equation} is written as:
\begin{align}
    P_t = \gamma_0 + [\theta(\alpha_1 + \alpha_2Z^{R}_{t})+ \gamma_1] Q_t   + \gamma_2 W_{t} + \gamma_3 R_t + \varepsilon^{c}_{t}.\label{eq:linear_supply_equation}
\end{align}
By substituting Equation \eqref{eq:linear_demand} into Equation \eqref{eq:linear_supply_equation} and solving it for $P_t$, we can represent the aggregate quantity $Q_t$ based on the parameters and exogenous variables as:
\begin{align}
    Q_t =  \frac{\alpha_0 + \alpha_3 Y_t - \gamma_0 - \gamma_2 W_{t} - \gamma_3 R_t + \varepsilon^{d}_{t} - \varepsilon^{c}_{t}}{(1 + \theta) (\alpha_1 + \alpha_2 Z^{R}_{t}) + \gamma_1}.\label{eq:quantity_linear}
\end{align}


\subsection{Log-linear demand and log-linear marginal cost}

Assume that log-linear demand and cost functions are specified as:
\begin{align}
    \log P_{t} &= \alpha_0 - (\alpha_1 + \alpha_2 Z^{R}_{t}) \log Q_t + \alpha_3 \log Y_t + \varepsilon^{d}_{t},\label{eq:log_linear_demand}\\
    \log MC_t &= \gamma_0 + \gamma_1 \log Q_t +  \gamma_2 \log W_{t} + \gamma_3 \log R_t + \varepsilon^{c}_{t}.\label{eq:log_linear_marginal_cost}
\end{align}
Since $\partial P_t/\partial Q_t = - (\alpha_1 + \alpha_2 Z_{t}^R) (P_t/Q_t) $, Equation \eqref{eq:supply_equation} is written as:
\begin{align*}
    P_t &= \theta (\alpha_1 + \alpha_2 Z^{R}_{t}) P_t + MC_t.
\end{align*}
By reformulating this and taking logarithm, $\log P_t(1 -\theta (\alpha_1 + \alpha_2 Z^{R}_{t})) = \log MC_t.$
Then, we obtain:
\begin{align}
    \log P_t = - \log(1 - \theta(\alpha_1 + \alpha_2 Z^{R}_{t})) + \gamma_0 + \gamma_1 \log Q_t +  \gamma_2 \log W_{t} + \gamma_3 \log R_t + \varepsilon^{c}_{t}. \label{eq:log_linear_supply_equation}
\end{align}
By substituting the Equation \eqref{eq:log_linear_demand} into Equation \eqref{eq:log_linear_supply_equation} and solving it for $P_{t}$, the log aggregate quantity is given as: 
\begin{align}
    \log Q_t &= \frac{ \alpha_0 + \alpha_3 \log Y_t + \log (1 - \theta (\alpha_1 + \alpha_2 Z^{R}_{t})) - \gamma_0  -  \gamma_2 \log W_{t} - \gamma_3 \log R_t + \varepsilon^{d}_{t} - \varepsilon^{c}_{t}}{\gamma_1+ \alpha_1 + \alpha_2 Z^{R}_{t} }.\label{eq:quantity_loglinear}
\end{align}


\subsection{Simulation and estimation Procedure}

We set the true parameters and distributions as in Table \ref{tb:parameter_setting}. 
As for the linear model, we follow the setting of PS.
As for the log-linear model, we need to use different data-generating processes from the linear model to generate reasonable data through the logarithmic transformation. 


\begin{table}[!htbp]
    \caption{True parameters and distributions}
    \label{tb:parameter_setting}
    \begin{center}
    \subfloat[Parameters]{
    \begin{tabular}{crr}
            \hline
            & linear & log-linear \\
            $\alpha_0$ & $10.0$ & $10.0$ \\
            $\alpha_1$ & $1.0$ & $1.0$  \\
            $\alpha_2$ & $1.0$ & $0.1$ \\
            $\alpha_3$ & $1.0$ & $1.0$ \\
            $\gamma_0$ & $1.0$ & $1.0$  \\
            $\gamma_1$ & $1.0$ & $1.0$  \\
            $\gamma_2$ & $1.0$ & $1.0$ \\
            $\gamma_3$ & $1.0$ & $1.0$ \\
            $\theta$ & $0.5$ & $0.3$  \\
            \hline
        \end{tabular}
    }
    \subfloat[Distributions]{
    \begin{tabular}{crr}
            \hline
            & linear & log-linear \\
            Demand shifter&  &  \\
            $Y_t$ & $N(0,1)$ & $N(0,1)$ \\
            Demand rotation instrument&  &  \\
            $Z^{R}_{t}$ & $N(10,1)$ & $U(0,1)$ \\
            Cost shifter&  &  \\
            $W_{t}$ & $N(3,1)$ & $U(1,3)$ \\
            $R_t$ & $N(0,1)$ & $U(0,1)$  \\
            $H_{t}$ & $W_{t}+N(0,1)$ & $W_{t}+U(0,1)$  \\
            $K_{t}$ & $R_{t}+N(0,1)$ & $R_{t}+U(0,1)$  \\
            Error&  &  \\
            $\varepsilon^{d}_{t}$ & $N(0,\sigma)$ & $N(0,\sigma)$  \\
            $\varepsilon^{c}_{t}$ & $N(0,\sigma)$ & $N(0,\sigma)$ \\
            \hline
        \end{tabular}
    }
    \end{center}
    \footnotesize
    Note: $\sigma=\{0.001, 0.5, 1.0, 2.0\}$. $N:$ Normal distribution. $U:$ Uniform distribution.
\end{table}

For the simulation, we generate 1000 data sets.
We separately estimate the demand and supply equation by 2SLS estimation.
The instrument variables for the demand estimation are $Z^{d}_{t} = (Z^{R}_{t}, Y_t, H_{t}, K_{t})$ and the instrument variables for the supply estimation are $Z^{c}_{t} = (Z^{R}_{t}, W_{t}, R_t, Y_t)$. 

%581words by Suguru

\section{Results}\label{sec:results}

Table \ref{tb:linear_linear_sigma_1} shows the results of the linear model with the demand shifter.
Panel (a) shows that when $\sigma = 0.001$, the estimation of all parameters is quite accurate.
When the sample size is large, the Root-mean-squared errors (RMSEs) of all parameters are less than or equal to 0.001. 
Panel (c) shows the case with $\sigma = 2.0$. As the sample size increases, the RMSE decreases dramatically. 
Thus, imprecise results reported in PS are due to the lack of demand shifters and the small sample size.



\begin{table}[!htbp]
  \begin{center}
      \caption{Results of the linear model with demand shifter}
      \label{tb:linear_linear_sigma_1} 
      \subfloat[$\sigma=0.001$]{\input{figuretable/linear_linear_sigma_0.001_bias_rmse.tex}}\\
      \subfloat[$\sigma=0.5$]{\input{figuretable/linear_linear_sigma_0.5_bias_rmse}}\\
    \subfloat[$\sigma=2.0$]{\input{figuretable/linear_linear_sigma_2_bias_rmse}}
  \end{center}
\end{table} 

Table \ref{tb:loglinear_loglinear_non_constraint} provides the results of the log-linear model with a demand shifter.
We calculate the bias and RMSE only from the simulation data whose GMM minimization problems are locally solved. 
First, we often cannot solve the log-linear model under the same data generating process. For example, when $\sigma=2$, we can solve 66.0\% of the 1000 simulated data.\footnote{The results depends on the tolerance level of the optimization. Even if we use some tight tolerance level, e.g., $10e-14$, we face the same problem discussed in Section \ref{sec:results} more severely. See the details in Appendix \ref{sec:appendix}.}
Second, the estimation of the conduct parameter fails as $\sigma$ becomes large. 
When $\sigma$ becomes larger, the bias and RMSE of the conduct parameter estimator take unreasonable values.

Figure \ref{fg:histogram_loglinear_loglinear_no_constraint} illustrates the histograms of the estimated conduct parameter from all simulations.
In each panel, the histogram has a peak around the true parameter.
While the conduct parameter is assumed to take a value between zero and one, we also see samples in which the values are out of the range. 
When $\sigma = 0.5$, 20.8\% of the simulations are out of $[0,1]$ and when $\sigma = 2.0$, 34.6\%. 
Previous papers including \citet{okazaki2022excess} also point out that the value of the estimated conduct parameter falls out of $[0,1]$.

\begin{table}[!htbp]
      \begin{center}
          \caption{Results of the log-linear model with demand shifter}
          \label{tb:loglinear_loglinear_non_constraint} 
          \subfloat[$\sigma=0.001$]{\input{figuretable/loglinear_loglinear_sigma_0.001_separate_non_constraint_non_constraint_bias_rmse.tex}}\\
          \subfloat[$\sigma=0.5$]{\input{figuretable/loglinear_loglinear_sigma_0.5_separate_non_constraint_non_constraint_bias_rmse}}\\
            \subfloat[$\sigma=2.0$]{\input{figuretable/loglinear_loglinear_sigma_2_separate_non_constraint_non_constraint_bias_rmse}}
      \end{center}
\end{table} 


\begin{figure}[!htbp]
  \begin{center}
  \subfloat[]{\includegraphics[width = 0.5\textwidth]
  {figuretable/histogram_loglinear_loglinear_n_1000_sigma_0.5_non_constraint.pdf}}
  \subfloat[]{\includegraphics[width = 0.5\textwidth]
  {figuretable/histogram_loglinear_loglinear_n_1000_sigma_2_non_constraint.pdf}}
  \caption{Histograms of the estimation result of the conduct parameter.}
  \label{fg:histogram_loglinear_loglinear_no_constraint} 
  \end{center}
\end{figure}

Why can such values arise as a solution of the GMM estimation?
To check this, for each simulation, we compute (1) the absolute differences between the true and estimated values of $\theta$ and $\gamma_0$ and (2) the absolute differences between the value of the GMM objective function under the true and estimated parameter.
Figure \ref{fg:diff_gmm_loglinear_loglinear} shows the plot of these differences. 
Each dot corresponds to each simulation and the color of each dot represents the value of the difference in the GMM objective function. 
We can see dark dots even when the difference in the conduct parameter is large.
For example, when $\sigma = 0.5$, dark dots appear when the difference is greater than 10.
When $\sigma = 2.0$, dark dots appear even when the difference is greater than 20.
While \citet{lau1982identifying} shows the joint identification of the conduct and cost parameter in a general case, Figure \ref{fg:diff_gmm_loglinear_loglinear} implies that the estimation becomes imprecise.


\begin{figure}[!htbp]
  \begin{center}
  \includegraphics[width = 0.45\textwidth]
  {figuretable/diff_gmm_value_loglinear_loglinear_n_1000_sigma_0.5_non_constraint.pdf}
  \includegraphics[width = 0.45\textwidth]
  {figuretable/diff_gmm_value_loglinear_loglinear_n_1000_sigma_2_non_constraint.pdf}
  \caption{The difference of the GMM objective function under true parameter and the estimation result}
  \label{fg:diff_gmm_loglinear_loglinear} 
  \end{center}
  \footnotesize
  Note: The x-axis is the difference between the values of the true and estimated conduct parameter. The y-axis is the difference between the values of estimated and true $\gamma_0$. Each dot represents the value of the difference of the GMM objective function under the true and estimated values of the parameters. 
\end{figure} 

%688words by Suguru

\section{Conclusion}
We revisit the conduct parameter estimation in homogeneous goods markets. In contrast to the pessimistic simulation results shown in PS, our simulation shows that the estimation becomes accurate by properly adding demand shifters in the supply estimation and increasing the sample size. We also show that the log-linear model recommended by PS has another estimation problem. Based on the numerical investigation, we conclude that at least the linear model can achieve a proper estimation of the conduct parameter in homogeneous good markets.
% 82 words

\paragraph{Acknowledgments}
We thank Jeremy Fox and Isabelle Perrigne for their valuable advice. This research did not receive any specific grant from funding agencies in the public, commercial, or not-for-profit sectors. 
% 26 words

\bibliographystyle{aer}
\bibliography{conduct_parameter}

\newpage
\appendix

\section{Details for our numerical settings and other experiments (Online appendix)}\label{sec:appendix}

\subsection{Details for our simulation settings}

To generate the simulation data, for each model, we first generate the exogenous variables $Y_t, Z_t^R, W_t, R_t, H_t$, and $K_t$ and the error terms $\varepsilon_{t}^c$ and $\varepsilon_{t}^d$ based on the data generation process in Table \ref{tb:parameter_setting}.
As for the linear model, we compute the equilibrium quantity $Q_t$ by \eqref{eq:quantity_linear}.
Then we compute the equilibrium price $P_t$ by substituting $Q_t$ and other variables into the demand function \eqref{eq:linear_demand}.
The simulation data of the loglinear model is also obtained in a similar way; compute the equilibrium log quantity $\log Q_t$ by \eqref{eq:quantity_loglinear}, and by substituting $\log Q_t$ and other variables into \eqref{eq:log_linear_demand}, we compute the equilibrium price.

As for the linear model, we estimate the equations by using the \texttt{ivreg} package in \texttt{R}.
Note that an important feature of the model is that we have an interaction term of the endogenous variable $Q_t$ and the instrument variable $Z^{R}_{t}$.
The \texttt{ivreg} package automatically detects that the endogenous variables are $Q_t$ and the interaction term $Z^{R}_{t}Q_t$ and runs the first stage regression for each endogenous variable by using the same instruments. To confirm this, we manually wrote R code that implements the 2SLS. 
When the first stage includes only the regression of $Q_t$, the estimation results from our code differ from the results from \texttt{ivreg}. 
But when we modified the code so that regress $Z^{R}_{t}Q_t$ on the instrument variables and estimate the second stage by using the predicted values of $Q_t$ and $Z^{R}_{t}Q_t$, the result from our code and the result from \texttt{ivreg} coincided.

As for the log-linear model, we estimate the demand parameters as in the linear model because the demand equation is linear.
In contrast, as the supply side equation is nonlinear, we apply the generalized method of moments (GMM) with the moment condition $E[Z^{c}_{t} \varepsilon^{c}_{t}] = 0$.
Note that for the supply estimation, we substitute the demand estimation result.
The GMM estimator is obtained as a solution to the minimization problem.
To solve the minimization problem, we use \texttt{Julia} and formulate the minimization problem via \texttt{JuMP.jl} and solve the problem by using the nonlinear solver \texttt{Ipopt.jl}. 
We use all starting values as zero, which is the default starting value in \texttt{JuMP.jl}, and the tolerance is $10^{-6}$.

To see whether the estimation problem explained in Section \ref{sec:results} depends on the tolerance value and the starting values, we conduct the same simulation with different tolerance values and starting values.
As for starting values, we use the true parameter values and randomly generated values.
To generate random starting values, we add random variables drawn from uniform distributions to the true parameter values. 
For the marginal cost parameters, we add random variables drawn from $U(-20, 20)$, and for the conduct parameter, we add a random variable drawn from $U(-10, 1)$. 
Note that a large value of $\theta$ may lead to an invalid number in equation \eqref{eq:log_linear_supply_equation}, we pick a random starting value under which the inside of log function in equation \eqref{eq:log_linear_supply_equation} is not negative.
As for tolerance, we use a tight tolerance $10^{-14}$.

The following histograms show the result of the simulation with different combinations of tolerance and starting values.
Only when we use the true value with tight tolerance, the histogram shows a 
normal distribution shape around the true parameter.
The runs-convergence rate is about 74\%, which is much higher than that of the simulation with the default starting value.
However, when we use random starting values and the loose tolerance, the histogram (b), (c), and (d) show failures of the estimation.
Especially, when we use loose tolerance, while the rate of convergence is 100\%, the estimation results are completely inaccurate.
We believe that these results are due to the flat shape of the GMM objective function.


\begin{figure}
    \begin{subfigure}[b]{0.475\textwidth}
         \centering
         \includegraphics[width=\textwidth]{figuretable/loose/histogram_loglinear_loglinear_n_1000_sigma_2_non_constraint_true_start.pdf}
         \caption{}
     \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.475\textwidth}
             \centering
             \includegraphics[width=\textwidth]{figuretable/loose/histogram_loglinear_loglinear_n_1000_sigma_2_non_constraint_random_start.pdf}
             \caption{}
        \end{subfigure}
     \hfill
    \vskip\baselineskip
    \begin{subfigure}[b]{0.475\textwidth}
         \centering
         \includegraphics[width=\textwidth]{figuretable/tight/histogram_loglinear_loglinear_n_1000_sigma_2_non_constraint_true_start.pdf}
         \caption{}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.475\textwidth}
         \centering
         \includegraphics[width=\textwidth]{figuretable/tight/histogram_loglinear_loglinear_n_1000_sigma_2_non_constraint_random_start.pdf}
         \caption{}
     \end{subfigure}
    \caption{The histogram of the estimated $\theta$ with different starting values and tolerances.}
    \footnotesize
    Note: The runs-convergence rate in each Panel is (a) 51\%, (b) 61.5\%, (c) 76.5\%, and (d) 71\%. Loose tolerance uses $10^{-6}$ and tight tolerance uses $10^{-14}$
    \label{fig:numerical_error}
\end{figure}




\subsection{Other experiments}

\begin{table}[!htbp]
    \caption{Estimation results in Table 2 of from PS}
    \label{tb:linear_linear_sigma_Perloff_Shen}
    \begin{center}
        \begin{tabular}{cllll}
            \hline
            & $\sigma=0.001$ & $\sigma=0.5$ & $\sigma=1$ & $\sigma=2$ \\
            $\alpha_0$ & $10.00\ (0.001)$ & $9.96\ (0.33)$ & $9.86\ (0.65)$ & $9.46 (1.20)$ \\
            $\alpha_1$ & $1.00\ (0.004)$ & $0.99\ (1.98)$ & $0.97\ (3.96)$ & $0.88 (7.80)$ \\
            $\alpha_2$ & $1.00\ (0.004)$ & $0.99\ (0.21)$ & $0.97\ (0.42)$ & $0.87\ (0.82)$ \\
            $\gamma_1$ & $0.46\ (0.88)$ & $0.46\ (0.91)$ & $0.47\ (0.93)$ & $0.49\ (1.04)$ \\
            $\gamma_2$ & $5.85\ (7.89)$ & $5.85\ (8.15)$ & $5.78\ (8.21)$ & $5.73\ (8.66)$ \\
            $\theta$ & $-0.31\ (1.31)$ & $-0.29\ (1.34)$ & $0.09\ (11.48)$ & $-1.53\ (30.41)$ \\
            \hline
        \end{tabular}
    \end{center}\footnotesize
    Note: True parameters: $\alpha_1 = \alpha_2 = \gamma_0 = \gamma_1 = \gamma_2  = \gamma_3 = 1, \alpha_0 = 10, \alpha_3 = 0,  \theta = 0.5$. PS exclude $Y_t$. We change the parameter notations from the original paper. Note that PS do not provide $\gamma_0$ and $\gamma_3$.
\end{table}

First, we replicate the result in PS. For comparison, we report the mean and standard deviation (SD).
To replicate the result, we exclude the demand shifter $Y_t$ and assume the coefficient $\alpha_3$ of $Y_t$ is zeros, that is, there is no demand shifter for the supply estimation.
For reference, Table \ref{tb:linear_linear_sigma_Perloff_Shen} is quoted from PS, although we modify some notations.
The sample size in each simulation data is 50 and the table shows the mean and SD of the 2SLS estimators from 1000 simulations.
It shows that the demand estimation becomes more accurate as the value of the SD of the error terms $\sigma$ decreases.
In contrast, the supply-side estimation is still biased and the SD of the conduct parameter becomes larger as the value of $\sigma$ increases.

Table \ref{tb:linear_linear_sigma_1_without_demand_shifter_y} shows our replication results.
Each panel shows the simulation result under different SDs of the error terms.
This result uses the same data generation process as PS. 
To see if we can correctly replicate the result in PS, focus on the first two columns in each panel.
These two columns show the mean and SD of the simulation result when the sample size is 50.
While the demand parameter can be accurately estimated even though the value of $\sigma$ becomes larger, the supply side parameter is biased.
Especially, when $\sigma$ is large and the sample size is small, the SD of the parameters in the supply-side equation becomes large.
Thus, we can see the patterns in PS which do not provide any details.

As PS fix the sample size to 50, we also see the effect of changing the sample size.
As expected, increasing the sample size given a value of $\sigma$ decreases the SD of the parameter in the supply equation.
However, no simulation result is close to the true values of the supply parameters and the conduct parameter.
These results are consistent with PS.

\begin{table}[!htbp]
  \begin{center}
      \caption{Estimation results of the linear model without demand shifter}
      \label{tb:linear_linear_sigma_1_without_demand_shifter_y} 
      \subfloat[$\sigma=0.001$]{\input{figuretable/linear_linear_sigma_0.001_without_demand_shifter_y}}\\
      \subfloat[$\sigma=0.5$]{\input{figuretable/linear_linear_sigma_0.5_without_demand_shifter_y}}\\
  \end{center}\footnotesize
  Note: True parameters: $\alpha_1 = \alpha_2 =  \gamma_0 = \gamma_1 = \gamma_2  =  1, \alpha_0 = 10, \theta = 0.5.$ and $\alpha_3 =0$. For comparison, we report mean and SD.
\end{table} 

\begin{table}[!htbp]
  \ContinuedFloat
  \begin{center}
      \caption{Estimation results of the linear model without demand shifter (Continued)}
      \subfloat[$\sigma=1.0$]{\input{figuretable/linear_linear_sigma_1_without_demand_shifter_y}}\\
    \subfloat[$\sigma=2.0$]{\input{figuretable/linear_linear_sigma_2_without_demand_shifter_y}}
  \end{center}\footnotesize
  Note: True parameters: $\alpha_1 = \alpha_2 =  \gamma_0 = \gamma_1 = \gamma_2  =  1, \alpha_0 = 10, \theta = 0.5.$ and $\alpha_3 =0$. For comparison, we report mean and SD.
\end{table} 

\begin{figure}[!htbp]
  \begin{center}
  \includegraphics[width = 0.45\textwidth]
  {figuretable/contour_loglinear_loglinear_n_1000_sigma_0.5.pdf}
  \includegraphics[width = 0.45\textwidth]
  {figuretable/contour_loglinear_loglinear_n_1000_sigma_2.pdf}
  \caption{Contour map of GMM objective function}
  \label{fg:contour_loglinear_loglinear_n_1000_sigma_2} 
  \end{center}
  \footnotesize
  Note: True parameters: $\alpha_1 = \alpha_3 = \gamma_0 = \gamma_1 = \gamma_2  = \gamma_3 = 1, \alpha_0 = 10, \alpha_2 = 0.1,  \theta = 0.3.$
\end{figure} 

Figure \ref{fg:contour_loglinear_loglinear_n_1000_sigma_2} illustrates the contour map of the GMM objective function with respect to $\gamma_0$ and $\theta$ for one typical data.
To draw the map, we fix the other demand and cost parameter values to the true values and set the grid size to 0.01.
We can see that the contour map has a flat region around the true parameters.
Especially, even though we vary the value of $\theta$, the GMM value does not change around the true value of $\gamma_0$.

First, note that in Table \ref{tb:loglinear_loglinear_non_constraint}, the mean of $\gamma_0$, the constant term in the log-linear marginal cost function, is far from the true parameter and the SD is large compared with other marginal cost parameters. 
Recall that the first and second term in the supply equation \eqref{eq:log_linear_supply_equation} is $-\log(1 - \theta(\alpha_1 + \alpha_2 Z^{R}_{t})) + \gamma_0$.
As the first term is always negative, for any value of $\theta$ that satisfies $1 - \theta(\alpha_1 + \alpha_2 Z^{R}_{t})$, we can find a value of $\gamma_0$ that cancel out the first and the second term each other.
Especially when the other estimated parameters are close to the true value, by adjusting the value of $\theta$ and $\gamma_0$ to cancel out the first and second term, we can make the value of the GMM objective function under the estimated parameters close to the value of the GMM objective function under the true parameter.


\end{document}