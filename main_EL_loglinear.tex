\documentclass[11pt, a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,setspace,geometry}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage[shortlabels]{enumitem}
\usepackage{rotating}
\usepackage{pdflscape}
\usepackage{graphicx}
\usepackage{bbm}
\usepackage[dvipsnames]{xcolor}
\usepackage{hyperref}
\hypersetup{colorlinks=true, linkcolor= BrickRed, citecolor = BrickRed, filecolor = BrickRed, urlcolor = BrickRed, hypertexnames = true}
\usepackage[]{natbib} 
\bibpunct[:]{(}{)}{,}{a}{}{,}
\geometry{left = 1.0in,right = 1.0in,top = 1.0in,bottom = 1.0in}
\usepackage[english]{babel}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{pdfpages}
\usepackage{threeparttable}
\usepackage{lscape}
\usepackage{bm}
\setstretch{1.4}
%\usepackage[tablesfirst,nolists]{endfloat}

\newtheorem{theorem}{Theorem}
\newtheorem{assumption}{Assumption}
\newtheorem{lemma}{Lemma}
\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}
\newtheorem{claim}{Claim}
\newtheorem{corollary}{Corollary}
\newtheorem{example}{Example}
\DeclareMathOperator{\rank}{rank}


\title{An MPEC Estimator for Conduct Parameter Estimation in Homogeneous Goods Markets}
\author{Yuri Matsumura\thanks{Department of Economics, Rice University. Email: Yuri.Matsumura@rice.edu} \and Suguru Otani \thanks{Department of Economics, Rice University. Email: so19@rice.edu
%Declarations of interest: none %this is for Economics Letters
}}

\begin{document}

\maketitle
\begin{abstract}
    \textcolor{blue}{We propose a constrained maximum likelihood estimator for conduct parameter estimation in homogeneous goods markets, by formulating the estimation as an MPEC (Mathematical Programming with Equilibrium Constraints) problem. Our approach avoids the complex transformation within the equilibrium conditions and allows more complex specifications which could not be estimated by standard approaches. Monte Carlo simulations confirm that the proposed estimator works with small bias and Root-Mean-Squared-Error for the typical specification, i.e., log-linear model.
    }
\end{abstract}


\section{Introduction}
Measuring competitiveness is one of the important tasks in empirical industrial organization literature.
Conduct parameter is considered to be a useful measure of competitiveness. 
However, it cannot be directly measured from data because data usually lack information about marginal cost.
Therefore, researchers endeavor to identify and estimate the conduct parameter.

As the simplest specification, \citet{bresnahan1982oligopoly} considers the identification of conduct parameter for the linear model. \cite{matsumura2023revisiting} resolves the conflict on identification problem between \cite{bresnahan1982oligopoly} and \cite{perloff2012collinearity} numerically and theoretically. On the other hand, researchers may want to implement a different set of specifications such as log-linear model, e.g., \cite{okazaki2022excess} and \cite{merel2009measuring}. As for the log-linear model, the identification strategy is provided by \citet{lau1982identifying}. 
\textcolor{blue}{Estimation problems arise for the case, however, when searching parameters using the standard solver because the equilibrium condition given by demand and supply curves involve log-transformation. This is the obstacle to choose the best specification of the demand and supply functions from the alternative set of different specifications.}


To overcome the problem, we propose a new estimator based on the mathematical program with equilibrium constraints (MPEC) approach advocated by \cite{su2012constrained}. MPEC is a constrained optimization problem whose constraint structure contains the equilibrium constraints. The basic idea is that we estimate the structural parameters by maximizing the likelihood or minimizing the objective function of the data with the constraints that endogenous economic variables are consistent with an equilibrium for the structural parameters. To implement MPEC, researchers write down expressions that define the objective function and the equilibrium equations as constraints and solve the constrained optimization problem using optimization solvers. 

\textcolor{blue}{We show that MPEC estimator works well for the log-linear model.[TBA]}


\section{Model}
The researcher has data with $T$ markets with homogeneous products.
Assume that there are $N$ firms in each market.
Let $t = 1,\ldots, T$ be the index of markets.
Then, we obtain the supply equation as follows:
\begin{align}
     P_t = -\theta\frac{\partial P_t(Q_{t})}{\partial Q_{t}}Q_{t} + MC_t(Q_{t}),\label{eq:supply_equation}
\end{align}
where $Q_{t}$ is the aggregate quantity, $P_t(Q_{t})$ is the demand function, $MC_{t}(Q_{t})$ is the marginal cost function, and $\theta\in[0,1]$, which is called conduct parameter. 
The equation nests perfect competition, $\theta=0$, Cournot competition, $\theta=1/N, N$ firm symmetric perfect collusion, $\theta=1$, etc.\footnote{See \cite{bresnahan1982oligopoly}.} 

Consider an econometric model of the above model.
Assume that the demand function and the marginal cost function are written as follows: 
\begin{align}
    P_t = f(Q_{t}, Y_t, \varepsilon^{d}_{t}, \alpha) \label{eq:demand}\\
    MC_t = g_{t}(Q_{t}, W_{t}, \varepsilon^{c}_{t}, \gamma)\label{eq:marginal_cost}
\end{align}
where $Y_t$ and $W_{t}$ are the vector of exogenous variables, $\varepsilon^{d}_{t}$ and $\varepsilon^{c}_{t}$ are the error terms, and $\alpha$ and $\gamma$ are the vector of parameters.
We also have the demand- and supply-side instrument variables $Z^{d}_{t}$ and $Z^{c}_{t}$, and assume that the error terms satisfy the mean independence condition $E[\varepsilon^{d}_{t}\mid Y_t, Z^{d}_{t}] = E[\varepsilon^{c}_{t} \mid W_{t}, Z^{c}_{t}] =0$.

\subsection{Log-linear demand and log-linear marginal cost}
We consider the most typical specification which is nonlinear-in-parameters as the log-linear model.
Assume that log-linear demand and cost functions are specified as:
\begin{align}
    \log P_{t} &= \alpha_0 - (\alpha_1 + \alpha_2 Z^{R}_{t}) \log Q_t + \alpha_3 \log Y_t + \varepsilon^{d}_{t},\label{eq:log_linear_demand}\\
    \log MC_t &= \gamma_0 + \gamma_1 \log Q_t +  \gamma_2 \log W_{t} + \gamma_3 \log R_t + \varepsilon^{c}_{t}.\label{eq:log_linear_marginal_cost}
\end{align}
Since $\partial P_t/\partial Q_t = - (\alpha_1 + \alpha_2 Z_{t}^R) (P_t/Q_t) $, Equation \eqref{eq:supply_equation} is written as:
\begin{align}
    P_t &= \theta (\alpha_1 + \alpha_2 Z^{R}_{t}) P_t + MC_t.\label{eq:log_linear_supply_equation_direct}
\end{align}
By reformulating this and taking logarithm, $\log P_t(1 -\theta (\alpha_1 + \alpha_2 Z^{R}_{t})) = \log MC_t.$
Then, we obtain:
\begin{align}
    \log P_t = - \log_{t}(1 - \theta(\alpha_1 + \alpha_2 Z^{R}_{t})) + \gamma_0 + \gamma_1 \log Q_t +  \gamma_2 \log W_{t} + \gamma_3 \log R_t + \varepsilon^{c}_{t}. \label{eq:log_linear_supply_equation}
\end{align}
By substituting the Equation \eqref{eq:log_linear_demand} into Equation \eqref{eq:log_linear_supply_equation} and solving it for $P_{t}$, the log aggregate quantity is given as: 
\begin{align}
    \log Q_t &= \frac{ \alpha_0 + \alpha_3 \log Y_t + \log (1 - \theta (\alpha_1 + \alpha_2 Z^{R}_{t})) - \gamma_0  -  \gamma_2 \log W_{t} - \gamma_3 \log R_t + \varepsilon^{d}_{t} - \varepsilon^{c}_{t}}{\gamma_1+ \alpha_1 + \alpha_2 Z^{R}_{t} }.\label{eq:quantity_loglinear}
\end{align}
\textcolor{blue}{An obstacle to estimate parameters is log-transformation. First, the standard numerical algorithm faces invalid errors when evaluating the term, $\log (1 - \theta (\alpha_1 + \alpha_2 Z^{R}_{t}))$, whose inner candidate value, $(1 - \theta (\alpha_1 + \alpha_2 Z^{R}_{t}))$, is negative. The problem is inevitable because the true values of parameters are unknown. As in practical situations, researchers may want to use multiple rotation demand instruments or conduct parameters varied with time- or market- fixed effects.\footnote{See \cite{michel2018estimating} for the case of differentiated goods markets.} Then, the problem regarding the term becomes severer because the number of parameters within the log term increases. Second, if researchers may want to specify the demand function as $P_t=\alpha_0-\left(\alpha_1+\alpha_2 Z_t^R\right) Q_t+\alpha_3 Y_t+\varepsilon_t^d$, then the supply equation is changed to $P_l=\theta \alpha_2 Z_l^R Q_t+\theta \alpha_1Q_t+\exp(\gamma_0+\gamma_1 \log Q_t+\gamma_2 \log W_t+\gamma_3 \log R_t+\varepsilon_t^c)$ which is nonlinear in cost parameters and conduct parameter $\theta$. When constructing moment conditions, researchers face the above problem on log-transformation, similarly.}

% \subsection{Log-linear demand and log-quadratic marginal cost}
% Next, we consider more nonlinear specification.
% Assume that the cost function is a log-quadratic form specified as:
% \begin{align}
%     \log MC_t &= \gamma_0 + \gamma_1 \log Q_t + \tilde{\gamma}_1 (\log Q_t)^{2} +  \gamma_2 \log W_{t} + \gamma_3 \log R_t + \varepsilon^{c}_{t}.
% \end{align}
% Then, the log aggregate quantity $\log Q_t $ is a solution of: 
% \begin{align}
%     (\log Q_t)^{2} + \frac{\gamma_1}{\tilde{\gamma}_{1}}\log Q_{t} +\frac{C}{\tilde{\gamma}_{1}} &= 0,
% \end{align}
% where $C=\alpha_0 + \alpha_3 \log Y_t + \log (1 - \theta (\alpha_1 + \alpha_2 Z^{R}_{t})) - \gamma_0  -  \gamma_2 \log W_{t} - \gamma_3 \log R_t + \varepsilon^{d}_{t} - \varepsilon^{c}_{t}$.
% Note that although this specification does not have an analytical solution, we can find numerically find a single positive solution.

\section{An MPEC estimator for the conduct parameter model}

We propose a novel estimator for the log-linear conduct parameter model by utilizing the Mathematical Programming with Equilibrium Constraints (MPEC) procedure advocated by \cite{su2012constrained}. \textcolor{blue}{MPEC estimator avoids the above log-transformation problem by evaluating the equilibrium equations involving log-transformation as constraints.} Let $\mathcal{T}$ be the set of markets. Let $\Xi$ be the set of parameters $\xi = (\alpha_0,\alpha_1, \ldots, \alpha_3, \gamma_0,\gamma_1, \ldots, \gamma_3, \theta)$. Then, we obtain $\xi\in \Xi$ by solving the following constrained optimization problem:
\begin{align}
    &\min_{\xi \in \Xi}\quad \left(\frac{1}{T}\sum_{t=1}^{T}g_{t}(\xi)\right)' W\left(\frac{1}{T}\sum_{t=1}^{T}g_{t}(\xi)\right) \label{eq:objective_gmm}\\
    \text{s.t.}\quad g_{t}(\xi)&=\left[\begin{array}{l}
\varepsilon^{d}_{t}(\xi)Z_{t}^{d} \\
\varepsilon^{c}_{t}(\xi)Z_{t}^{c}
\end{array}\right], \quad W=\frac{1}{T}(Z'Z)^{-1}, \quad Z=\left[\begin{array}{c}
Z_{1} \\
\vdots \\
Z_{t}
\end{array}\right],\quad Z_{t}=\left[\begin{array}{ll}
Z_{t}^{d} & 0 \\
0 & Z_{t}^{c}
\end{array}\right],\quad  \forall t \in \mathcal{T}\nonumber\\
    \varepsilon^{d}_{t}(\xi)&=\log P_{t} -[\alpha_0 - (\alpha_1 + \alpha_2 Z^{R}_{t}) \log Q_t + \alpha_3 \log Y_t],\quad  \forall t \in \mathcal{T} \label{eq:demand_gmm}\\
    \varepsilon^{c}_{t} (\xi)&= \log MC_t -[\gamma_0 + \gamma_1 \log Q_t +  \gamma_2 \log W_{t} + \gamma_3 \log R_t],\quad  \forall t \in \mathcal{T}\label{eq:supply_gmm}\\
    MC_t &= P_t(1 - \theta (\alpha_1 + \alpha_2 Z^{R}_{t})),\quad  \forall t \in \mathcal{T},\label{eq:equilibrium_constraint}\\
    &0\le\theta \le 1,\quad  0 \le \alpha_0,\quad  0\le \gamma_0 \label{eq:parameter_constraint}
\end{align}
where $W$ is the weighting matrix, Equation \eqref{eq:objective_gmm} is the GMM objective function of simultaneous equation model, 
Equations \eqref{eq:demand_gmm} and \eqref{eq:supply_gmm} are specifications of demand \eqref{eq:log_linear_demand} and supply curves \eqref{eq:log_linear_marginal_cost}, 
Equation \eqref{eq:equilibrium_constraint} is the equilibrium constraint from Equation \eqref{eq:log_linear_supply_equation_direct}, and Equation \eqref{eq:parameter_constraint} are constraints on the conduct parameter and constant term parameters of the demand and supply curves. Constraints \eqref{eq:parameter_constraint} are practically necessary to avoid searching theoretically implausible parameters from the theoretical model. MPEC allows for more flexible specifications on Equations \eqref{eq:demand_gmm}, \eqref{eq:supply_gmm}, and \eqref{eq:equilibrium_constraint} that the standard optimization does not allow. 



\subsection{Simulation and estimation Procedure}

We assess the performance of the MPEC estimator using Monte Carlo simulation.
We set the true parameters and distributions as in Table \ref{tb:parameter_setting}. 
For the simulation, we generate 1000 data sets. We jointly estimate the demand and supply equation by simultaneous equation model.
The instrument variables for the demand estimation are $Z^{d}_{t} = (Z^{R}_{t}, Y_t, H_{t}, K_{t})$ and the instrument variables for the supply estimation are $Z^{c}_{t} = (Z^{R}_{t}, W_{t}, R_t, Y_t)$. 


\begin{table}[!htbp]
    \caption{True parameters and distributions}
    \label{tb:parameter_setting}
    \begin{center}
    \subfloat[Parameters]{
    \begin{tabular}{cr}
            \hline
            & log-linear \\
            $\alpha_0$  & $10.0$ \\
            $\alpha_1$ & $1.0$  \\
            $\alpha_2$ & $0.1$ \\
            $\alpha_3$ & $1.0$ \\
            $\gamma_0$ & $5.0$  \\
            $\gamma_1$ & $1.0$  \\
            $\gamma_2$ & $1.0$ \\
            $\gamma_3$ & $1.0$ \\
            $\theta$ & $0.2$  \\
            \hline
        \end{tabular}
    }
    \subfloat[Distributions]{
    \begin{tabular}{crr}
            \hline
            &  log-linear \\
            Demand shifter&  &  \\
            $Y_t$ & $N(0,1)$ \\
            Demand rotation instrument&  &  \\
            $Z^{R}_{t}$ & $U(0,1)$ \\
            Cost shifter  &  \\
            $W_{t}$ & $U(1,3)$ \\
            $R_t$  & $U(1,3)$  \\
            $H_{t}$ & $W_{t}+U(0,1)$  \\
            $K_{t}$ & $R_{t}+U(0,1)$  \\
            Error&  &  \\
            $\varepsilon^{d}_{t}$ & $N(0,\sigma)$  \\
            $\varepsilon^{c}_{t}$ & $N(0,\sigma)$ \\
            \hline
        \end{tabular}
    }
    \end{center}
    \footnotesize
    Note: $\sigma=\{0.001, 0.5, 2.0\}$. $N:$ Normal distribution. $U:$ Uniform distribution.
\end{table}



%581words by Suguru

\section{Simulation results}\label{sec:results}

Table \ref{tb:loglinear_loglinear_sigma_2_mpec_non_constraint_theta_constraint} presents that [TBA]


\begin{table}[!htbp]
  \begin{center}
      \caption{MPEC Results of the log-linear model}
      \label{tb:loglinear_loglinear_sigma_2_mpec_non_constraint_theta_constraint} 
      \subfloat[$\sigma=0.001$]{\input{figuretable/loglinear_loglinear_sigma_0.001_mpec_non_constraint_theta_constraint_bias_rmse}}\\
      \subfloat[$\sigma=0.5$]{\input{figuretable/loglinear_loglinear_sigma_0.5_mpec_non_constraint_theta_constraint_bias_rmse}}\\
    \subfloat[$\sigma=2.0$]{\input{figuretable/loglinear_loglinear_sigma_2_mpec_non_constraint_theta_constraint_bias_rmse}}
  \end{center}
  \footnotesize
  Note: 
\end{table} 



\section{Conclusion}
[TBA]
% We revisit the conduct parameter estimation in homogeneous goods markets.
% There is a conflict between \citet{bresnahan1982oligopoly} and \citet{perloff2012collinearity} in terms of identification and estimation.
% We highlight the problems in the proof and simulation in \citet{perloff2012collinearity}.
% Our simulation shows that the estimation of the conduct parameter becomes accurate by appropriately introducing demand shifters into the supply estimation and increasing the sample size. 
% Based on the theoretical and numerical investigation, we support the argument in \citet{bresnahan1982oligopoly}.


\paragraph{Acknowledgments}
We thank Jeremy Fox and Isabelle Perrigne for their valuable advice. This research did not receive any specific grant from funding agencies in the public, commercial, or not-for-profit sectors. 

\newpage

\bibliographystyle{aer}
\bibliography{conduct_parameter}

\newpage
\appendix

\section{MPEC for a linear model}

We illustrate that MPEC works for a linear model as in Two-Stage-Least-Square (2SLS) approach in \cite{matsumura2023revisiting}. 
% We confirm that the simultaneous equation model in which demand and supply parameters are jointly estimated and 2SLS model in which demand and supply parameters are separately estimated generate the similar results. 
We follow the setting of \cite{matsumura2023revisiting}.
We put an additional restriction such that $\theta\in[0,1]$ as a theoretical restriction. Table \ref{tb:linear_linear_sigma_2_mpec_linear_non_constraint_theta_constraint_bias_rmse} shows that MPEC estimator reduces bias and RMSE in particular when the sample size is large rather than 2SLS estimator shown in Table \ref{tb:linear_linear_sigma_1}.



\begin{table}[!htbp]
  \begin{center}
      \caption{MPEC Results of the linear model}
      \label{tb:linear_linear_sigma_2_mpec_linear_non_constraint_theta_constraint_bias_rmse} 
      \subfloat[$\sigma=0.001$]{\input{figuretable/linear_linear_sigma_0.001_mpec_linear_non_constraint_theta_constraint_bias_rmse}}\\
      \subfloat[$\sigma=0.5$]{\input{figuretable/linear_linear_sigma_0.5_mpec_linear_non_constraint_theta_constraint_bias_rmse}}\\
    \subfloat[$\sigma=2.0$]{\input{figuretable/linear_linear_sigma_2_mpec_linear_non_constraint_theta_constraint_bias_rmse}}
  \end{center}
  \footnotesize
  Note: The data generating process follows \cite{matsumura2023revisiting}.
\end{table} 


\begin{table}[!htbp]
  \begin{center}
      \caption{2SLS Results of the linear model}
      \label{tb:linear_linear_sigma_1} 
      \subfloat[$\sigma=0.001$]{\input{figuretable/linear_linear_sigma_0.001_bias_rmse.tex}}\\
      \subfloat[$\sigma=0.5$]{\input{figuretable/linear_linear_sigma_0.5_bias_rmse}}\\
    \subfloat[$\sigma=2.0$]{\input{figuretable/linear_linear_sigma_2_bias_rmse}}
  \end{center}
  \footnotesize
  Note: This table is cited from \cite{matsumura2023revisiting}.
\end{table} 

\end{document}