---
title: "04construct_figuretable"
author: "Suguru Otani"
date: "2022/12/03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load

```{r,echo=FALSE,results = "hide"}
rm(list = ls())
library(magrittr)
library(ggplot2)
# we need to use old version of modelsummary for latex output
if(1 == 0){
  devtools::install_version(
    "modelsummary",
    version = "0.9.4", 
    repos = "http://cran.us.r-project.org")
  }
library(modelsummary) # for N in datasummary
# set constant ----
n_observation_list <-
  c(
    50,
    100,
    200,
    1000
    )
sigma_list <-
  c(
    0.001,
    0.5, 
    1.0, 
    2.0
    )

# linear with demand shifter
for(nn in 1:length(n_observation_list)){
  for(ss in 1:length(sigma_list)){
    temp_nn <-
      n_observation_list[nn]
    temp_sigma <-
      sigma_list[ss]
    filename <-
      paste(
        "linear_linear_",
        "n_",
        temp_nn,
        "_sigma_",
        temp_sigma,
        sep = ""
      )
    temp_data <-
      readRDS(
        file =
          here::here(
            paste(
              "output/",
              "parameter_hat_table",
              filename,
              ".rds",
              sep = ""
              )
            )
        )
    temp_data <-
      temp_data %>% 
      dplyr::rename(
        `$\\alpha_{0}$` =
          alpha0_hat,
        `$\\alpha_{1}$` =
          alpha1_hat,
        `$\\alpha_{2}$` =
          alpha2_hat,
        `$\\alpha_{3}$` =
          alpha3_hat,
        `$\\gamma_{0}$` =
          gamma0_hat,
        `$\\gamma_{1}$` =
          gamma1_hat,
        `$\\gamma_{2}$` =
          gamma2_hat,
        `$\\gamma_{3}$` =
          gamma3_hat,
        `$\\theta$` =
          theta_hat,
        `$R^{2}$ (demand)` =
          R2_demand,
        `$R^{2}$ (supply)` =
          R2_supply) %>% 
      dplyr::mutate(
        filename =
          paste(
            "(",
            nn,
            ") ",
            "$n=",
            temp_nn,
            "$",
            sep = ""
            )
        )
    assign(
      filename,
      temp_data) 
  }
}

# mpec linear with demand shifter
for(nn in 1:length(n_observation_list)){
  for(ss in 1:length(sigma_list)){
    temp_nn <-
      n_observation_list[nn]
    temp_sigma <-
      sigma_list[ss]
    filename <-
      paste(
        "linear_linear_",
        "n_",
        temp_nn,
        "_sigma_",
        temp_sigma,
        "_mpec_linear_non_constraint_theta_constraint",
        sep = ""
      )
    temp_data <-
      readr::read_csv(
          file =
            here::here(
              paste(
                "output/",
                "parameter_hat_table_",
                filename,
                ".csv",
                sep = ""
                )
              ),
          show_col_types = FALSE
          )
    # drop T, sigma, status
      temp_data <-
        temp_data[
          ,-c(
            1, # T
            2, # sigma
            12 # status
            )]
      colnames(temp_data) <-
        c(
          "alpha0_hat",
          "alpha1_hat",
          "alpha2_hat",
          "alpha3_hat",
          "gamma0_hat",
          "gamma1_hat",
          "gamma2_hat",
          "gamma3_hat",
          "theta_hat",
          "status_indicator"
          )
      temp_data <-
        temp_data %>% 
        dplyr::rename(
          `$\\alpha_{0}$` =
            alpha0_hat,
          `$\\alpha_{1}$` =
            alpha1_hat,
          `$\\alpha_{2}$` =
            alpha2_hat,
          `$\\alpha_{3}$` =
            alpha3_hat,
          `$\\gamma_{0}$` =
            gamma0_hat,
          `$\\gamma_{1}$` =
            gamma1_hat,
          `$\\gamma_{2}$` =
            gamma2_hat,
          `$\\gamma_{3}$` =
            gamma3_hat,
          `$\\theta$` =
            theta_hat#,
        # `$R^{2}$ (demand)` =
        #   R2_demand,
        # `$R^{2}$ (supply)` =
        #   R2_supply
        ) %>% 
      dplyr::mutate(
        filename =
          paste(
            "(",
            nn,
            ") ",
            "$n=",
            temp_nn,
            "$",
            sep = ""
            ),
        locally_solved_percent =
          format(
            round(
              sum(
                status_indicator,
                na.rm = TRUE)/
                dim(temp_data)[1],
              digits = 3) * 100,
               nsmall = 3)
        )
    assign(
      filename,
      temp_data) 
  }
}

# linear without demand shifter
for(nn in 1:length(n_observation_list)){
  for(ss in 1:length(sigma_list)){
    temp_nn <-
      n_observation_list[nn]
    temp_sigma <-
      sigma_list[ss]
    filename <-
      paste(
        "linear_linear_",
        "n_",
        temp_nn,
        "_sigma_",
        temp_sigma,
        "_without_demand_shifter_y",
        sep = ""
      )
    temp_data <-
      readRDS(
        file =
          here::here(
            paste(
              "output/",
              "parameter_hat_table",
              filename,
              ".rds",
              sep = ""
              )
            )
        )
    temp_data <-
      temp_data %>% 
      dplyr::rename(
        `$\\alpha_{0}$` =
          alpha0_hat,
        `$\\alpha_{1}$` =
          alpha1_hat,
        `$\\alpha_{2}$` =
          alpha2_hat,
        # `$\\alpha_{3}$` =
        #   alpha3_hat,
        `$\\gamma_{0}$` =
          gamma0_hat,
        `$\\gamma_{1}$` =
          gamma1_hat,
        `$\\gamma_{2}$` =
          gamma2_hat,
        # `$\\gamma_{3}$` =
        #   gamma3_hat,
        `$\\theta$` =
          theta_hat,
        `$R^{2}$ (demand)` =
          R2_demand,
        `$R^{2}$ (supply)` =
          R2_supply) %>% 
      dplyr::mutate(
        filename =
          paste(
            "(",
            nn,
            ") ",
            "$n=",
            temp_nn,
            "$",
            sep = ""
            )
        )
    assign(
      filename,
      temp_data)
  }
}



# 2sls loglinear with constraint
constraint_list <-
  c(
    "_separate_non_constraint_non_constraint",
    "_separate_non_constraint_theta_constraint",
    "_separate_log_constraint_theta_constraint",
    "_simultaneous_non_constraint_non_constraint",
    "_simultaneous_non_constraint_theta_constraint",
    "_simultaneous_log_constraint_theta_constraint"
    )
for(nn in 1:length(n_observation_list)){
  for(ss in 1:length(sigma_list)){
    for(cc in 1:length(constraint_list)){
      temp_nn <-
        n_observation_list[nn]
      temp_sigma <-
        sigma_list[ss]
      temp_constraint <-
        constraint_list[cc]
      filename <-
        paste(
          "loglinear_loglinear_",
          "n_",
          temp_nn,
          "_sigma_",
          temp_sigma,
          temp_constraint,
          sep = ""
          )
      temp_data <-
        readr::read_csv(
          file =
            here::here(
              paste(
                "output/",
                "parameter_hat_table_",
                filename,
                ".csv",
                sep = ""
                )
              ),
          show_col_types = FALSE
          )
      # drop T, sigma, status
      temp_data <-
        temp_data[
          ,-c(
            1, # T
            2, # sigma
            12 # status
            )]
      colnames(temp_data) <-
        c(
          "alpha0_hat",
          "alpha1_hat",
          "alpha2_hat",
          "alpha3_hat",
          "gamma0_hat",
          "gamma1_hat",
          "gamma2_hat",
          "gamma3_hat",
          "theta_hat",
          "status_indicator"
          )
      temp_data <-
        temp_data %>% 
        dplyr::rename(
          `$\\alpha_{0}$` =
            alpha0_hat,
          `$\\alpha_{1}$` =
            alpha1_hat,
          `$\\alpha_{2}$` =
            alpha2_hat,
          `$\\alpha_{3}$` =
            alpha3_hat,
          `$\\gamma_{0}$` =
            gamma0_hat,
          `$\\gamma_{1}$` =
            gamma1_hat,
          `$\\gamma_{2}$` =
            gamma2_hat,
          `$\\gamma_{3}$` =
            gamma3_hat,
          `$\\theta$` =
            theta_hat#,
        # `$R^{2}$ (demand)` =
        #   R2_demand,
        # `$R^{2}$ (supply)` =
        #   R2_supply
        ) %>% 
      dplyr::mutate(
        filename =
          paste(
            "(",
            nn,
            ") ",
            "$n=",
            temp_nn,
            "$",
            sep = ""
            ),
        locally_solved_percent =
          format(
            round(
              sum(
                status_indicator,
                na.rm = TRUE)/
                dim(temp_data)[1],
              digits = 3) * 100,
               nsmall = 3)
        )
    assign(
      filename,
      temp_data) 
    
    }
  }
}


# mpec loglinear with demand shifter
constraint_list <-
  c("_mpec_non_constraint_non_constraint",
    "_mpec_non_constraint_theta_constraint")
for(nn in 1:length(n_observation_list)){
  for(ss in 1:length(sigma_list)){
    for(cc in 1:length(constraint_list)){
      temp_nn <-
        n_observation_list[nn]
      temp_sigma <-
        sigma_list[ss]
      temp_constraint <-
        constraint_list[cc]
      filename <-
        paste(
          "loglinear_loglinear_",
          "n_",
          temp_nn,
          "_sigma_",
          temp_sigma,
          temp_constraint,
          sep = ""
          )
      temp_data <-
        readr::read_csv(
          file =
            here::here(
              paste(
                "output/",
                "parameter_hat_table_",
                filename,
                ".csv",
                sep = ""
                )
              ),
          show_col_types = FALSE
          )
      # drop T, sigma, status
      temp_data <-
        temp_data[
          ,-c(
            1, # T
            2, # sigma
            12 # status
            )]
      colnames(temp_data) <-
        c(
          "alpha0_hat",
          "alpha1_hat",
          "alpha2_hat",
          "alpha3_hat",
          "gamma0_hat",
          "gamma1_hat",
          "gamma2_hat",
          "gamma3_hat",
          "theta_hat",
          "status_indicator"
          )
      temp_data <-
        temp_data %>% 
        dplyr::rename(
          `$\\alpha_{0}$` =
            alpha0_hat,
          `$\\alpha_{1}$` =
            alpha1_hat,
          `$\\alpha_{2}$` =
            alpha2_hat,
          `$\\alpha_{3}$` =
            alpha3_hat,
          `$\\gamma_{0}$` =
            gamma0_hat,
          `$\\gamma_{1}$` =
            gamma1_hat,
          `$\\gamma_{2}$` =
            gamma2_hat,
          `$\\gamma_{3}$` =
            gamma3_hat,
          `$\\theta$` =
            theta_hat#,
        # `$R^{2}$ (demand)` =
        #   R2_demand,
        # `$R^{2}$ (supply)` =
        #   R2_supply
        ) %>% 
      dplyr::mutate(
        filename =
          paste(
            "(",
            nn,
            ") ",
            "$n=",
            temp_nn,
            "$",
            sep = ""
            ),
        locally_solved_percent =
          format(
            round(
              sum(
                status_indicator,
                na.rm = TRUE)/
                dim(temp_data)[1],
              digits = 3) * 100,
               nsmall = 3)
        )
    assign(
      filename,
      temp_data) 
    
    }
  }
}

create_table_with_demand_shifter <-
  function(target_data){
    f_with_demand_shifter <-
  (`$\\alpha_{0}$` +
  `$\\alpha_{1}$`+
  `$\\alpha_{2}$`+
  `$\\alpha_{3}$`+
  `$\\gamma_{0}$`+
  `$\\gamma_{1}$`+
  `$\\gamma_{2}$`+
  `$\\gamma_{3}$`+
  `$\\theta$`+
  `$R^{2}$ (demand)`+
  `$R^{2}$ (supply)` ) ~
  filename * (Mean + SD)*Arguments(na.rm = TRUE)
    filelocation <-
      paste(
        "figuretable/",
        deparse(
          substitute(
            target_data
            )
          ),
        as.character(),
        ".tex",
        sep = "")
    new_rows <- 
      data.frame(
        "Sample size ($T$)",
        "",
        "50",
        "",
        "100",
        "",
        "200",
        "",
        "1000")
    target_data %>%
      modelsummary::datasummary(
        f_with_demand_shifter,
        escape = FALSE,
        fmt = 3,
        data = .,
        add_rows = new_rows,
        output = "latex_tabular"
        ) %>%
      gsub("\\multicolumn.*\\\\", "", .) %>%
      kableExtra::save_kable(
        file = here::here(
          filelocation)
        )
    res <-
      modelsummary::datasummary(
        f_with_demand_shifter,
        data = target_data,
        fmt = 3,
        add_rows = new_rows,
        notes = filelocation)
    return(res)
  }




create_table_without_demand_shifter <-
  function(target_data){
    f_without_demand_shifter <-
  (`$\\alpha_{0}$` +
  `$\\alpha_{1}$`+
  `$\\alpha_{2}$`+
  #`$\\alpha_{3}$`+
  `$\\gamma_{0}$`+
  `$\\gamma_{1}$`+
  `$\\gamma_{2}$`+
  #`$\\gamma_{3}$`+
  `$\\theta$`+
  `$R^{2}$ (demand)`+
  `$R^{2}$ (supply)` 
  ) ~
  filename * (Mean + SD)*Arguments(na.rm = TRUE)
    filelocation <-
      paste(
        "figuretable/",
        deparse(
          substitute(
            target_data
            )
          ),
        as.character(),
        ".tex",
        sep = "")
    new_rows <- 
      data.frame(
        "Sample size ($T$)",
        "",
        "50",
        "",
        "100",
        "",
        "200",
        "",
        "1000")
    target_data %>%
      modelsummary::datasummary(
        f_without_demand_shifter,
        escape = FALSE,
        fmt = 3,
        data = .,
        add_rows = new_rows,
        output = "latex_tabular"
        ) %>%
      gsub("\\multicolumn.*\\\\", "", .) %>%
      kableExtra::save_kable(
        file = here::here(
          filelocation)
        )
    res <-
      modelsummary::datasummary(
        f_without_demand_shifter,
        data = target_data,
        fmt = 3,
        add_rows = new_rows,
        notes = filelocation)
    return(res)
  }

create_table_loglinear_mpec_with_demand_shifter <-
  function(target_data){
    f_with_demand_shifter <-
  (`$\\alpha_{0}$` +
  `$\\alpha_{1}$`+
  `$\\alpha_{2}$`+
  `$\\alpha_{3}$`+
  `$\\gamma_{0}$`+
  `$\\gamma_{1}$`+
  `$\\gamma_{2}$`+
  `$\\gamma_{3}$`+
  `$\\theta$`#+
  #`$R^{2}$ (demand)`+
  #`$R^{2}$ (supply)`
  ) ~
  filename * (Mean + SD)*Arguments(na.rm = TRUE)
    filelocation <-
      paste(
        "figuretable/",
        deparse(
          substitute(
            target_data
            )
          ),
        as.character(),
        ".tex",
        sep = "")
    new_rows <- 
      data.frame(
        "Sample size ($T$)",
        "",
        "50",
        "",
        "100",
        "",
        "200",
        "",
        "1000")
    target_data %>%
      modelsummary::datasummary(
        f_with_demand_shifter,
        escape = FALSE,
        fmt = 3,
        data = .,
        add_rows = new_rows,
        output = "latex_tabular"
        ) %>%
      gsub("\\multicolumn.*\\\\", "", .) %>%
      kableExtra::save_kable(
        file = here::here(
          filelocation)
        )
    res <-
      modelsummary::datasummary(
        f_with_demand_shifter,
        data = target_data,
        fmt = 3,
        add_rows = new_rows,
        notes = filelocation)
    return(res)
  }

create_table_loglinear_with_demand_shifter <-
  function(target_data){
    f_with_demand_shifter <-
  (`$\\alpha_{0}$` +
  `$\\alpha_{1}$`+
  `$\\alpha_{2}$`+
  `$\\alpha_{3}$`+
  `$\\gamma_{0}$`+
  `$\\gamma_{1}$`+
  `$\\gamma_{2}$`+
  `$\\gamma_{3}$`+
  `$\\theta$`#+
  #`$R^{2}$ (demand)`+
  #`$R^{2}$ (supply)` 
  ) ~
  filename * (Mean + SD)*Arguments(na.rm = TRUE)
    filelocation <-
      paste(
        "figuretable/",
        deparse(
          substitute(
            target_data
            )
          ),
        as.character(),
        ".tex",
        sep = "")
    locally_solved_list <-
      target_data %>% 
      dplyr::distinct(
        filename,
        locally_solved_percent
      )
    col_dim <-
      length(
        unique(
          target_data$filename)
        )
    if(col_dim == 4){
      sample_size_row <-
      data.frame(
        "Sample size ($T$)",
        "",
        "50",
        "",
        "100",
        "",
        "200",
        "",
        "1000")
    locally_solved_row <- 
      data.frame(
        "Runs converged (\\%)",
        "",
        locally_solved_list[1,2],
        "",
        locally_solved_list[2,2],
        "",
        locally_solved_list[3,2],
        "",
        locally_solved_list[4,2])
    }else{
      sample_size_row <-
      data.frame(
        "Sample size ($T$)",
        "",
        "50",
        # "",
        # "100",
        "",
        "200")
    locally_solved_row <- 
      data.frame(
        "Runs converged (\\%)",
        "",
        locally_solved_list[1,2],
        # "",
        # locally_solved_list[2,2],
        "",
        locally_solved_list[3,2])
    }
    
    # keep consistency of colnames for latex
    colnames(locally_solved_row) <-
      colnames(
        sample_size_row)
    new_rows <-
      rbind(
        locally_solved_row,
        sample_size_row)
    # pick up locally solved id
    target_data <-
      target_data %>% 
       dplyr::filter(
         status_indicator == 1
       )
    target_data %>%
      modelsummary::datasummary(
        f_with_demand_shifter,
        escape = FALSE,
        fmt = 3,
        data = .,
        add_rows = new_rows,
        output = "latex_tabular"
        ) %>%
      gsub("\\multicolumn.*\\\\", "", .) %>%
      kableExtra::save_kable(
        file = here::here(
          filelocation)
        )
    res <-
      modelsummary::datasummary(
        f_with_demand_shifter,
        data = target_data,
        fmt = 3,
        add_rows = new_rows,
        notes = filelocation)
    return(res)
  }



options(modelsummary_format_numeric_latex = "plain") # for modelsummary output
```


# Estimation {.tabset}

## linear-demand linear-cost {.tabset}

### with demand shifter {.tabset}

#### 2SLS

```{r,echo=FALSE,results = "asis"}
linear_linear_sigma_0.001 <-
  rbind(
    linear_linear_n_50_sigma_0.001,
    linear_linear_n_100_sigma_0.001,
    linear_linear_n_200_sigma_0.001,
    linear_linear_n_1000_sigma_0.001)
create_table_with_demand_shifter(
  linear_linear_sigma_0.001
)
linear_linear_sigma_0.5 <-
  rbind(
    linear_linear_n_50_sigma_0.5,
    linear_linear_n_100_sigma_0.5,
    linear_linear_n_200_sigma_0.5,
    linear_linear_n_1000_sigma_0.5)
create_table_with_demand_shifter(
  linear_linear_sigma_0.5
)

linear_linear_sigma_1 <-
  rbind(
    linear_linear_n_50_sigma_1,
    linear_linear_n_100_sigma_1,
    linear_linear_n_200_sigma_1,
    linear_linear_n_1000_sigma_1)
create_table_with_demand_shifter(
  linear_linear_sigma_1
)

linear_linear_sigma_2 <-
  rbind(
    linear_linear_n_50_sigma_2,
    linear_linear_n_100_sigma_2,
    linear_linear_n_200_sigma_2,
    linear_linear_n_1000_sigma_2)
create_table_with_demand_shifter(
  linear_linear_sigma_2
)

```



#### mpec

```{r,echo=FALSE,results = "asis"}
linear_linear_sigma_0.001_mpec_linear_non_constraint_theta_constraint <-
  rbind(
    linear_linear_n_50_sigma_0.001_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_100_sigma_0.001_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_200_sigma_0.001_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_1000_sigma_0.001_mpec_linear_non_constraint_theta_constraint)
create_table_loglinear_mpec_with_demand_shifter(
  linear_linear_sigma_0.001_mpec_linear_non_constraint_theta_constraint
)
linear_linear_sigma_0.5_mpec_linear_non_constraint_theta_constraint <-
  rbind(
    linear_linear_n_50_sigma_0.5_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_100_sigma_0.5_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_200_sigma_0.5_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_1000_sigma_0.5_mpec_linear_non_constraint_theta_constraint)
create_table_loglinear_mpec_with_demand_shifter(
  linear_linear_sigma_0.5_mpec_linear_non_constraint_theta_constraint
)

linear_linear_sigma_1_mpec_linear_non_constraint_theta_constraint <-
  rbind(
    linear_linear_n_50_sigma_1_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_100_sigma_1_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_200_sigma_1_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_1000_sigma_1_mpec_linear_non_constraint_theta_constraint)
create_table_loglinear_mpec_with_demand_shifter(
  linear_linear_sigma_1_mpec_linear_non_constraint_theta_constraint
)

linear_linear_sigma_2_mpec_linear_non_constraint_theta_constraint <-
  rbind(
    linear_linear_n_50_sigma_2_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_100_sigma_2_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_200_sigma_2_mpec_linear_non_constraint_theta_constraint,
    linear_linear_n_1000_sigma_2_mpec_linear_non_constraint_theta_constraint)
create_table_loglinear_mpec_with_demand_shifter(
  linear_linear_sigma_2_mpec_linear_non_constraint_theta_constraint
)

```


### without demand shifter {.tabset}

```{r,echo=FALSE,results = "asis"}
linear_linear_sigma_0.001_without_demand_shifter_y <-
  rbind(
    linear_linear_n_50_sigma_0.001_without_demand_shifter_y,
    linear_linear_n_100_sigma_0.001_without_demand_shifter_y,
    linear_linear_n_200_sigma_0.001_without_demand_shifter_y,
    linear_linear_n_1000_sigma_0.001_without_demand_shifter_y)
create_table_without_demand_shifter(
  linear_linear_sigma_0.001_without_demand_shifter_y
)
linear_linear_sigma_0.5_without_demand_shifter_y <-
  rbind(
    linear_linear_n_50_sigma_0.5_without_demand_shifter_y,
    linear_linear_n_100_sigma_0.5_without_demand_shifter_y,
    linear_linear_n_200_sigma_0.5_without_demand_shifter_y,
    linear_linear_n_1000_sigma_0.5_without_demand_shifter_y)
create_table_without_demand_shifter(
  linear_linear_sigma_0.5_without_demand_shifter_y
)

linear_linear_sigma_1_without_demand_shifter_y <-
  rbind(
    linear_linear_n_50_sigma_1_without_demand_shifter_y,
    linear_linear_n_100_sigma_1_without_demand_shifter_y,
    linear_linear_n_200_sigma_1_without_demand_shifter_y,
    linear_linear_n_1000_sigma_1_without_demand_shifter_y)
create_table_without_demand_shifter(
  linear_linear_sigma_1_without_demand_shifter_y
)

linear_linear_sigma_2_without_demand_shifter_y <-
  rbind(
    linear_linear_n_50_sigma_2_without_demand_shifter_y,
    linear_linear_n_100_sigma_2_without_demand_shifter_y,
    linear_linear_n_200_sigma_2_without_demand_shifter_y,
    linear_linear_n_1000_sigma_2_without_demand_shifter_y)
create_table_without_demand_shifter(
  linear_linear_sigma_2_without_demand_shifter_y
)
```




## log-linear-demand log-linear-cost with demand shifter {.tabset}

### non_constraint_non_constraint {.tabset}

#### separate {.tabset}

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_separate_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.001_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.001_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.001_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_separate_non_constraint_non_constraint
        )
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.001_separate_non_constraint_non_constraint
)
loglinear_loglinear_sigma_0.5_separate_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.5_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.5_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.5_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_separate_non_constraint_non_constraint
        )
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.5_separate_non_constraint_non_constraint
)

loglinear_loglinear_sigma_1_separate_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_1_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_1_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_1_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_1_separate_non_constraint_non_constraint
        )
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_1_separate_non_constraint_non_constraint
)

loglinear_loglinear_sigma_2_separate_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_2_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_2_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_2_separate_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_2_separate_non_constraint_non_constraint
        )
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_2_separate_non_constraint_non_constraint
)

```


#### simultaneous {.tabset}

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_simultaneous_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.001_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.001_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.001_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_simultaneous_non_constraint_non_constraint
        )
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.001_simultaneous_non_constraint_non_constraint
)
loglinear_loglinear_sigma_0.5_simultaneous_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.5_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.5_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.5_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_simultaneous_non_constraint_non_constraint
        )
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.5_simultaneous_non_constraint_non_constraint
)

loglinear_loglinear_sigma_1_simultaneous_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_1_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_1_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_1_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_1_simultaneous_non_constraint_non_constraint
        )
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_1_simultaneous_non_constraint_non_constraint
)

loglinear_loglinear_sigma_2_simultaneous_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_2_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_2_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_2_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_2_simultaneous_non_constraint_non_constraint
        )
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_2_simultaneous_non_constraint_non_constraint
)

```


#### mpec

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_mpec_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.001_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.001_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.001_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_mpec_non_constraint_non_constraint
        )
create_table_loglinear_mpec_with_demand_shifter(
  loglinear_loglinear_sigma_0.001_mpec_non_constraint_non_constraint
)
loglinear_loglinear_sigma_0.5_mpec_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.5_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.5_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.5_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_mpec_non_constraint_non_constraint
        )
create_table_loglinear_mpec_with_demand_shifter(
  loglinear_loglinear_sigma_0.5_mpec_non_constraint_non_constraint
)

loglinear_loglinear_sigma_1_mpec_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_1_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_1_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_1_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_1_mpec_non_constraint_non_constraint
        )
create_table_loglinear_mpec_with_demand_shifter(
  loglinear_loglinear_sigma_1_mpec_non_constraint_non_constraint
)

loglinear_loglinear_sigma_2_mpec_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_2_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_2_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_2_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_2_mpec_non_constraint_non_constraint
        )
create_table_loglinear_mpec_with_demand_shifter(
  loglinear_loglinear_sigma_2_mpec_non_constraint_non_constraint
)

```


### non_constraint_theta_constraint {.tabset}

#### separate

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_separate_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.001_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.001_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.001_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_separate_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.001_separate_non_constraint_theta_constraint
)
loglinear_loglinear_sigma_0.5_separate_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.5_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.5_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.5_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_separate_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.5_separate_non_constraint_theta_constraint
)

loglinear_loglinear_sigma_1_separate_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_1_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_1_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_1_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_1_separate_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_1_separate_non_constraint_theta_constraint
)

loglinear_loglinear_sigma_2_separate_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_2_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_2_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_2_separate_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_2_separate_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_2_separate_non_constraint_theta_constraint
)

```

#### simultaneous

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_simultaneous_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.001_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.001_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.001_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_simultaneous_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.001_simultaneous_non_constraint_theta_constraint
)
loglinear_loglinear_sigma_0.5_simultaneous_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.5_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.5_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.5_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_simultaneous_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.5_simultaneous_non_constraint_theta_constraint
)

loglinear_loglinear_sigma_1_simultaneous_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_1_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_1_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_1_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_1_simultaneous_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_1_simultaneous_non_constraint_theta_constraint
)

loglinear_loglinear_sigma_2_simultaneous_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_2_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_2_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_2_simultaneous_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_2_simultaneous_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_2_simultaneous_non_constraint_theta_constraint
)

```





#### mpec

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_mpec_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.001_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.001_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.001_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_mpec_non_constraint_theta_constraint)
create_table_loglinear_mpec_with_demand_shifter(
  loglinear_loglinear_sigma_0.001_mpec_non_constraint_theta_constraint
)
loglinear_loglinear_sigma_0.5_mpec_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.5_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.5_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.5_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_mpec_non_constraint_theta_constraint)
create_table_loglinear_mpec_with_demand_shifter(
  loglinear_loglinear_sigma_0.5_mpec_non_constraint_theta_constraint
)

loglinear_loglinear_sigma_1_mpec_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_1_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_1_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_1_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_1_mpec_non_constraint_theta_constraint)
create_table_loglinear_mpec_with_demand_shifter(
  loglinear_loglinear_sigma_1_mpec_non_constraint_theta_constraint
)

loglinear_loglinear_sigma_2_mpec_non_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_2_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_2_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_2_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_2_mpec_non_constraint_theta_constraint)
create_table_loglinear_mpec_with_demand_shifter(
  loglinear_loglinear_sigma_2_mpec_non_constraint_theta_constraint
)

```




### log_constraint_theta_constraint {.tabset}

#### separate

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_separate_log_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.001_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.001_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.001_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_separate_log_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.001_separate_log_constraint_theta_constraint
)
loglinear_loglinear_sigma_0.5_separate_log_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.5_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.5_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.5_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_separate_log_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.5_separate_log_constraint_theta_constraint
)

loglinear_loglinear_sigma_1_separate_log_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_1_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_1_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_1_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_1_separate_log_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_1_separate_log_constraint_theta_constraint
)

loglinear_loglinear_sigma_2_separate_log_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_2_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_2_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_2_separate_log_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_2_separate_log_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_2_separate_log_constraint_theta_constraint
)

```

#### simultaneous

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_simultaneous_log_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.001_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.001_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.001_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_simultaneous_log_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.001_simultaneous_log_constraint_theta_constraint
)
loglinear_loglinear_sigma_0.5_simultaneous_log_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.5_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.5_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.5_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_simultaneous_log_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_0.5_simultaneous_log_constraint_theta_constraint
)

loglinear_loglinear_sigma_1_simultaneous_log_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_1_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_1_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_1_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_1_simultaneous_log_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_1_simultaneous_log_constraint_theta_constraint
)

loglinear_loglinear_sigma_2_simultaneous_log_constraint_theta_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_2_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_2_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_2_simultaneous_log_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_2_simultaneous_log_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter(
  loglinear_loglinear_sigma_2_simultaneous_log_constraint_theta_constraint
)

```

