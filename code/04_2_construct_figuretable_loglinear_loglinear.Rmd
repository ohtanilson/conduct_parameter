---
title: "04_2_construct_figuretable_loglinear_loglinear"
author: "Suguru Otani"
date: "2022/12/03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE)
```

# Load

```{r, echo=FALSE, results = "hide", warning=FALSE}
rm(list = ls())
library(magrittr)
library(ggplot2)
# we need to use old version of modelsummary for latex output
if(1 == 0){
  devtools::install_version(
    "modelsummary",
    version = "0.9.4", 
    repos = "http://cran.us.r-project.org")
  }
library(modelsummary) # for N in datasummary
# set constant ----
n_observation_list <-
  c(
    50,
    100, 
    200, 
    1000
    )
sigma_list <-
  c(
    0.001,
    0.5, 
    1.0, 
    2.0
    )

n_observation_list <-
  c(
    #50,
    100, 
    200, 
    1000,
    1500 #addd
    )
constraint_list <-
  c(
    "_separate_non_constraint_non_constraint",
    "_separate_theta_constraint_non_constraint",
    "_separate_theta_constraint_slope_constraint",
    #"_separate_log_constraint_theta_constraint",
    "_simultaneous_non_constraint_non_constraint",
    "_simultaneous_theta_constraint_non_constraint",
    "_simultaneous_theta_constraint_slope_constraint"#,
    #"_simultaneous_log_constraint_theta_constraint",
    #"_optim_nelder_mead_theta_constraint_slope_constraint"
    )
# loglinear with constraint
for(nn in 1:length(n_observation_list)){
  for(ss in 1:length(sigma_list)){
    for(cc in 1:length(constraint_list)){
      temp_nn <-
        n_observation_list[nn]
      temp_sigma <-
        sigma_list[ss]
      temp_constraint <-
        constraint_list[cc]
      filename <-
        paste(
          "loglinear_loglinear_",
          "n_",
          temp_nn,
          "_sigma_",
          temp_sigma,
          temp_constraint,
          sep = ""
          )
      temp_data <-
        readr::read_csv(
          file =
            here::here(
              paste(
                "output/",
                "parameter_hat_table_",
                filename,
                ".csv",
                sep = ""
                )
              ),
          show_col_types = FALSE
          )
      # drop T, sigma, status
      temp_data <-
        temp_data[
          ,-c(
            1, # T
            2, # sigma
            12 # status
            )]
      colnames(temp_data) <-
        c(
          "alpha0_hat",
          "alpha1_hat",
          "alpha2_hat",
          "alpha3_hat",
          "gamma0_hat",
          "gamma1_hat",
          "gamma2_hat",
          "gamma3_hat",
          "theta_hat",
          "status_indicator"
          )
      temp_data <-
        temp_data %>% 
        dplyr::rename(
          `$\\alpha_{0}$` =
            alpha0_hat,
          `$\\alpha_{1}$` =
            alpha1_hat,
          `$\\alpha_{2}$` =
            alpha2_hat,
          `$\\alpha_{3}$` =
            alpha3_hat,
          `$\\gamma_{0}$` =
            gamma0_hat,
          `$\\gamma_{1}$` =
            gamma1_hat,
          `$\\gamma_{2}$` =
            gamma2_hat,
          `$\\gamma_{3}$` =
            gamma3_hat,
          `$\\theta$` =
            theta_hat#,
        # `Mean $R^{2}$ (demand)` =
        #   R2_demand,
        # `Mean $R^{2}$ (supply)` =
        #   R2_supply
        ) %>% 
      dplyr::mutate(
        filename =
          paste(
            "(",
            nn,
            ") ",
            "$n=",
            temp_nn,
            "$",
            sep = ""
            ),
        locally_solved_percent =
          format(
            round(
              sum(
                status_indicator,
                na.rm = TRUE)/
                dim(temp_data)[1],
              digits = 3) * 100,
               nsmall = 3)
        )
    assign(
      filename,
      temp_data) 
    
    }
  }
}
# mpec loglinear with demand shifter
# non_constraint_non_constraint for n = 50, 100, 200, 1000
constraint_list <-
  c(#"_mpec_separate_theta_constraint_slope_constraint",
    "_mpec_non_constraint_non_constraint"#,
    #"_mpec_non_constraint_theta_constraint",
    #"_mpec_theta_constraint_slope_constraint"
    )
n_observation_list <-
  c(
    50,
    100, 
    200, 
    1000#,
    #1500 #addd
    )
for(nn in 1:length(n_observation_list)){
  for(ss in 1:length(sigma_list)){
    for(cc in 1:length(constraint_list)){
      temp_nn <-
        n_observation_list[nn]
      temp_sigma <-
        sigma_list[ss]
      temp_constraint <-
        constraint_list[cc]
      filename <-
        paste(
          "loglinear_loglinear_",
          "n_",
          temp_nn,
          "_sigma_",
          temp_sigma,
          temp_constraint,
          sep = ""
          )
      temp_data <-
        readr::read_csv(
          file =
            here::here(
              paste(
                "output/",
                "parameter_hat_table_",
                filename,
                ".csv",
                sep = ""
                )
              ),
          show_col_types = FALSE
          )
      # drop T, sigma, status
      temp_data <-
        temp_data[
          ,-c(
            1, # T
            2, # sigma
            12 # status
            )]
      colnames(temp_data) <-
        c(
          "alpha0_hat",
          "alpha1_hat",
          "alpha2_hat",
          "alpha3_hat",
          "gamma0_hat",
          "gamma1_hat",
          "gamma2_hat",
          "gamma3_hat",
          "theta_hat",
          "status_indicator"
          )
      temp_data <-
        temp_data %>% 
        dplyr::rename(
          `$\\alpha_{0}$` =
            alpha0_hat,
          `$\\alpha_{1}$` =
            alpha1_hat,
          `$\\alpha_{2}$` =
            alpha2_hat,
          `$\\alpha_{3}$` =
            alpha3_hat,
          `$\\gamma_{0}$` =
            gamma0_hat,
          `$\\gamma_{1}$` =
            gamma1_hat,
          `$\\gamma_{2}$` =
            gamma2_hat,
          `$\\gamma_{3}$` =
            gamma3_hat,
          `$\\theta$` =
            theta_hat#,
        # `$R^{2}$ (demand)` =
        #   R2_demand,
        # `$R^{2}$ (supply)` =
        #   R2_supply
        ) %>% 
      dplyr::mutate(
        filename =
          paste(
            "(",
            nn,
            ") ",
            "$n=",
            temp_nn,
            "$",
            sep = ""
            ),
        locally_solved_percent =
          format(
            round(
              sum(
                status_indicator,
                na.rm = TRUE)/
                dim(temp_data)[1],
              digits = 3) * 100,
               nsmall = 3)
        )
    assign(
      filename,
      temp_data
      ) 
    
    }
  }
}

# loglinear main results
n_observation_list <-
  c(
    #50,
    100, 
    200, 
    1000,
    1500 #addd
    )
constraint_list <-
  c(#"_mpec_separate_theta_constraint_slope_constraint",
    #"_mpec_non_constraint_non_constraint",
    "_mpec_non_constraint_theta_constraint",
    "_mpec_theta_constraint_slope_constraint"
    )
for(nn in 1:length(n_observation_list)){
  for(ss in 1:length(sigma_list)){
    for(cc in 1:length(constraint_list)){
      temp_nn <-
        n_observation_list[nn]
      temp_sigma <-
        sigma_list[ss]
      temp_constraint <-
        constraint_list[cc]
      filename <-
        paste(
          "loglinear_loglinear_",
          "n_",
          temp_nn,
          "_sigma_",
          temp_sigma,
          temp_constraint,
          sep = ""
          )
      temp_data <-
        readr::read_csv(
          file =
            here::here(
              paste(
                "output/",
                "parameter_hat_table_",
                filename,
                ".csv",
                sep = ""
                )
              ),
          show_col_types = FALSE
          )
      # drop T, sigma, status
      temp_data <-
        temp_data[
          ,-c(
            1, # T
            2, # sigma
            12 # status
            )]
      colnames(temp_data) <-
        c(
          "alpha0_hat",
          "alpha1_hat",
          "alpha2_hat",
          "alpha3_hat",
          "gamma0_hat",
          "gamma1_hat",
          "gamma2_hat",
          "gamma3_hat",
          "theta_hat",
          "status_indicator"
          )
      temp_data <-
        temp_data %>% 
        dplyr::rename(
          `$\\alpha_{0}$` =
            alpha0_hat,
          `$\\alpha_{1}$` =
            alpha1_hat,
          `$\\alpha_{2}$` =
            alpha2_hat,
          `$\\alpha_{3}$` =
            alpha3_hat,
          `$\\gamma_{0}$` =
            gamma0_hat,
          `$\\gamma_{1}$` =
            gamma1_hat,
          `$\\gamma_{2}$` =
            gamma2_hat,
          `$\\gamma_{3}$` =
            gamma3_hat,
          `$\\theta$` =
            theta_hat#,
        # `$R^{2}$ (demand)` =
        #   R2_demand,
        # `$R^{2}$ (supply)` =
        #   R2_supply
        ) %>% 
      dplyr::mutate(
        filename =
          paste(
            "(",
            nn,
            ") ",
            "$n=",
            temp_nn,
            "$",
            sep = ""
            ),
        locally_solved_percent =
          format(
            round(
              sum(
                status_indicator,
                na.rm = TRUE)/
                dim(temp_data)[1],
              digits = 3) * 100,
               nsmall = 3)
        )
    assign(
      filename,
      temp_data
      ) 
    
    }
  }
}


# read gmm objective value
constraint_list <-
  c(
    # "_separate_non_constraint_non_constraint",
    # "_separate_theta_constraint_non_constraint",
    # "_separate_theta_constraint_slope_constraint",
    #"_separate_log_constraint_theta_constraint",
    # "_simultaneous_non_constraint_non_constraint",
    # "_simultaneous_theta_constraint_non_constraint",
    "_simultaneous_theta_constraint_slope_constraint",
    #"_simultaneous_log_constraint_theta_constraint",
    #"_optim_nelder_mead_theta_constraint_slope_constraint"
    "_mpec_theta_constraint_slope_constraint"
    )
sigma_list <-
  c(
    #0.001,
    0.5, 
    1.0, 
    2.0
    )
for(nn in 1:length(n_observation_list)){
  for(ss in 1:length(sigma_list)){
    for(cc in 1:length(constraint_list)){
      temp_nn <-
        n_observation_list[nn]
      temp_sigma <-
        sigma_list[ss]
      temp_constraint <-
        constraint_list[cc]
      filename <-
        paste(
          "loglinear_loglinear_",
          "n_",
          temp_nn,
          "_sigma_",
          temp_sigma,
          temp_constraint,
          sep = ""
          )
      
      # load gmm obj value
      temp_data <-
          readr::read_csv(
            file =
              here::here(
                paste(
                  "output/",
                  "gmm_objective_value_",
                  filename,
                  ".csv",
                  sep = ""
                  )
                ),
            show_col_types = FALSE
            )
        # drop id
        temp_data_obj_value <-
          temp_data[,2]
        colnames(temp_data_obj_value)[1] <-
          "gmm_objective_value"
      
      temp_data <-
        readr::read_csv(
          file =
            here::here(
              paste(
                "output/",
                "parameter_hat_table_",
                filename,
                ".csv",
                sep = ""
                )
              ),
          show_col_types = FALSE
          )
      # drop T, sigma, status
      temp_data <-
        temp_data[
          ,-c(
            1, # T
            2, # sigma
            12 # status
            )]
      colnames(temp_data) <-
        c(
          "alpha0_hat",
          "alpha1_hat",
          "alpha2_hat",
          "alpha3_hat",
          "gamma0_hat",
          "gamma1_hat",
          "gamma2_hat",
          "gamma3_hat",
          "theta_hat",
          "status_indicator"
          )
      temp_data <-
        temp_data %>% 
        dplyr::rename(
          `$\\alpha_{0}$` =
            alpha0_hat,
          `$\\alpha_{1}$` =
            alpha1_hat,
          `$\\alpha_{2}$` =
            alpha2_hat,
          `$\\alpha_{3}$` =
            alpha3_hat,
          `$\\gamma_{0}$` =
            gamma0_hat,
          `$\\gamma_{1}$` =
            gamma1_hat,
          `$\\gamma_{2}$` =
            gamma2_hat,
          `$\\gamma_{3}$` =
            gamma3_hat,
          `$\\theta$` =
            theta_hat#,
        # `$R^{2}$ (demand)` =
        #   R2_demand,
        # `$R^{2}$ (supply)` =
        #   R2_supply
        ) %>% 
      dplyr::mutate(
        filename =
          paste(
            "(",
            nn,
            ") ",
            "$n=",
            temp_nn,
            "$",
            sep = ""
            ),
        locally_solved_percent =
          format(
            round(
              sum(
                status_indicator,
                na.rm = TRUE)/
                dim(temp_data)[1],
              digits = 3) * 100,
               nsmall = 3)
        )
      temp_data <-
        cbind(
          temp_data,
          temp_data_obj_value
        )
    assign(
      filename,
      temp_data
      ) 
    }
  }
}

true_parameter_loglinear <-
  c(
    20,#10,
    1,
    0.1,#target_alpha2
    1,
    5, # gamma0
    1,
    1,
    1,
    0.5#0.2
    )



create_table_loglinear_with_demand_shifter_bias_rmse <-
  function(target_data){
    # pick up locally converged id
    # target_data <-
    #   target_data %>%
    #    dplyr::filter(
    #      status_indicator == 1
    #    )
    locally_solved_list <-
      target_data %>% 
      dplyr::distinct(
        filename,
        locally_solved_percent
      )
    locally_solved_row <- 
      data.frame(
        #"Runs converged (\\%)",
        "",
        locally_solved_list[1,2],
        "",
        locally_solved_list[2,2],
        "",
        locally_solved_list[3,2],
        "",
        locally_solved_list[4,2]#,
        # "",
        # locally_solved_list[5,2]
        )
    bias_info <-
      target_data %>%
      # dplyr::group_by(
      #   filename,
      #   status_indicator
      #   ) %>% 
      # dplyr::mutate(
      #   converged_some_samples_indicator =
      #     ifelse(
      #       sum(status_indicator) > 0,
      #       1,
      #       0
      #     )
      # ) %>% 
       dplyr::filter(
         status_indicator == 1
       ) %>% 
      dplyr::group_by(filename) %>% 
      # Redefine variables as the errors
      dplyr::summarise(
        `$\\alpha_{0}$` =
          mean(`$\\alpha_{0}$` -
                 true_parameter_loglinear[1],
               na.rm = TRUE),
        `$\\alpha_{1}$` =
          mean(`$\\alpha_{1}$` -
                 true_parameter_loglinear[2],
               na.rm = TRUE),
        `$\\alpha_{2}$` =
          mean(`$\\alpha_{2}$` -
                 true_parameter_loglinear[3],
               na.rm = TRUE),
        `$\\alpha_{3}$` =
          mean(`$\\alpha_{3}$` -
                 true_parameter_loglinear[4],
               na.rm = TRUE),
        `$\\gamma_{0}$` =
          mean(`$\\gamma_{0}$` - 
                 true_parameter_loglinear[5],
               na.rm = TRUE),
        `$\\gamma_{1}$` =
          mean(`$\\gamma_{1}$` -
                 true_parameter_loglinear[6],
               na.rm = TRUE),
        `$\\gamma_{2}$` =
          mean(`$\\gamma_{2}$` -
                 true_parameter_loglinear[7],
               na.rm = TRUE),
        `$\\gamma_{3}$` =
          mean(`$\\gamma_{3}$` - 
                 true_parameter_loglinear[8],
               na.rm = TRUE),
        `$\\theta$` =
          mean(`$\\theta$` -
                 true_parameter_loglinear[9],
               na.rm = TRUE)
      ) %>% 
      dplyr::ungroup()
    rmse_info <-
      target_data %>%
       dplyr::filter(
         status_indicator == 1
       ) %>% 
      dplyr::group_by(filename) %>% 
      dplyr::summarise(
        `$\\alpha_{0}$` =
          sqrt(mean((`$\\alpha_{0}$` -
                       true_parameter_loglinear[1])^2,
               na.rm = TRUE)),
        `$\\alpha_{1}$` =
          sqrt(mean((`$\\alpha_{1}$` -
                       true_parameter_loglinear[2])^2,
               na.rm = TRUE)),
        `$\\alpha_{2}$` =
          sqrt(mean((`$\\alpha_{2}$` -
                       true_parameter_loglinear[3])^2,
               na.rm = TRUE)),
        `$\\alpha_{3}$` =
          sqrt(mean((`$\\alpha_{3}$` -
                       true_parameter_loglinear[4])^2,
               na.rm = TRUE)),
        `$\\gamma_{0}$` =
          sqrt(mean((`$\\gamma_{0}$` -
                       true_parameter_loglinear[5])^2,
               na.rm = TRUE)),
        `$\\gamma_{1}$` =
          sqrt(mean((`$\\gamma_{1}$` -
                       true_parameter_loglinear[6])^2,
               na.rm = TRUE)),
        `$\\gamma_{2}$` =
          sqrt(mean((`$\\gamma_{2}$` -
                       true_parameter_loglinear[7])^2,
               na.rm = TRUE)),
        `$\\gamma_{3}$` =
          sqrt(mean((`$\\gamma_{3}$` -
                       true_parameter_loglinear[8])^2,
               na.rm = TRUE)),
        `$\\theta$` =
          sqrt(mean((`$\\theta$` -
                       true_parameter_loglinear[9])^2,
               na.rm = TRUE))
      ) %>% 
      dplyr::ungroup()
    file_name_list <-
      unique(target_data$filename)
    
    for(nn in 1:length(file_name_list)){
      temp_file_name <-
        as.character(
          file_name_list[nn])
      if(locally_solved_list$locally_solved_percent[nn] !=
         "0.000"){
        temp_bias <-
          bias_info %>% 
          dplyr::filter(
            filename == 
              temp_file_name
            )
        temp_rmse <-
          rmse_info %>% 
          dplyr::filter(
            filename == 
              temp_file_name
            )
      }else{
        # no data converged
        temp_bias <-
          bias_info %>% 
          dplyr::filter(
            filename == 
              temp_file_name
            )
        temp_bias[1,1] <-
          temp_file_name
        temp_rmse <-
          rmse_info %>% 
          dplyr::filter(
            filename == 
              temp_file_name
            )
        temp_rmse[1,1] <-
          temp_file_name
      }
      
      
      temp_bias_rmse <-
        data.frame(
          "Bias" = 
            format(
              round(
                t(temp_bias[-1]),
                digits = 3),
              nsmall = 3),
          "RMSE" = 
            format(
              round(
                t(temp_rmse[-1]),
                digits = 3),
              nsmall = 3)
          )
      if(nn == 1){
        all_bias_rmse <-
          temp_bias_rmse
      }else{
        #merge 
        all_bias_rmse <-
          cbind(
            all_bias_rmse,
            temp_bias_rmse)
      }
    }
    new_rows <-
      data.frame(
        #"Sample size ($T$)",
        # "",
        # "50",
        "",
        "100",
        "",
        "200",
        "",
        "1000",
        "",
        "1500"
        )
    
    # keep consistency of colnames for latex
    colnames(new_rows) <-
      colnames(all_bias_rmse)
    colnames(locally_solved_row) <-
      colnames(all_bias_rmse)
    all_bias_rmse_for_latex <-
      rbind(
        all_bias_rmse,
        locally_solved_row,
        new_rows)
    rownames(all_bias_rmse_for_latex)[10] <-
      "Runs converged (\\%)"
    rownames(all_bias_rmse_for_latex)[11] <-
      "Sample size ($T$)"
    filelocation <-
      paste(
        "figuretable/",
        deparse(
          substitute(
            target_data
            )
          ),
        as.character(),
        "_bias_rmse",
        ".tex",
        sep = "")
    all_bias_rmse_for_latex %>%
      kableExtra::kbl(
        format = "latex",
        #align = c("l","r","r","r","r","r","r","r","r"),
        align = c("r","r","r","r","r","r","r","r","r"),
        escape = FALSE,
        booktabs = TRUE,
        linesep = ""
      ) %>%
      kableExtra::save_kable(
        file = here::here(
          filelocation
        )
      )
    res <-
      all_bias_rmse_for_latex %>% 
      kableExtra::kable() %>% 
      kableExtra::kable_styling()
    return(res)
  }

options(modelsummary_format_numeric_latex = "plain") # for modelsummary output
```


# Estimation {.tabset}

## log-linear-demand log-linear-cost with demand shifter {.tabset}

<!-- ### non_constraint_non_constraint {.tabset} -->

<!-- #### separate {.tabset} -->

<!-- ```{r,echo=FALSE,results = "asis"} -->
<!-- loglinear_loglinear_sigma_0.001_separate_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.001_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.001_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.001_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.001_separate_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.001_separate_non_constraint_non_constraint -->
<!-- ) -->
<!-- loglinear_loglinear_sigma_0.5_separate_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.5_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.5_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.5_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.5_separate_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.5_separate_non_constraint_non_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_1_separate_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_1_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_1_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_1_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_1_separate_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_1_separate_non_constraint_non_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_2_separate_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_2_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_2_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_2_separate_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_2_separate_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_2_separate_non_constraint_non_constraint -->
<!-- ) -->

<!-- ``` -->

<!-- #### simultaneous {.tabset} -->

<!-- ```{r,echo=FALSE,results = "asis"} -->
<!-- loglinear_loglinear_sigma_0.001_simultaneous_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.001_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.001_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.001_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.001_simultaneous_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.001_simultaneous_non_constraint_non_constraint -->
<!-- ) -->
<!-- loglinear_loglinear_sigma_0.5_simultaneous_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.5_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.5_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.5_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.5_simultaneous_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.5_simultaneous_non_constraint_non_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_1_simultaneous_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_1_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_1_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_1_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_1_simultaneous_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_1_simultaneous_non_constraint_non_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_2_simultaneous_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_2_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_2_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_2_simultaneous_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_2_simultaneous_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_2_simultaneous_non_constraint_non_constraint -->
<!-- ) -->

<!-- ``` -->



<!-- #### mpec -->

<!-- ```{r,echo=FALSE,results = "asis"} -->
<!-- loglinear_loglinear_sigma_0.001_mpec_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.001_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.001_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.001_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.001_mpec_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.001_mpec_non_constraint_non_constraint -->
<!-- ) -->
<!-- loglinear_loglinear_sigma_0.5_mpec_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.5_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.5_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.5_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.5_mpec_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.5_mpec_non_constraint_non_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_1_mpec_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_1_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_1_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_1_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_1_mpec_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_1_mpec_non_constraint_non_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_2_mpec_non_constraint_non_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_2_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_2_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_2_mpec_non_constraint_non_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_2_mpec_non_constraint_non_constraint -->
<!--         ) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_2_mpec_non_constraint_non_constraint -->
<!-- ) -->

<!-- ``` -->






### theta_constraint_non_constraint {.tabset}

#### separate

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_separate_theta_constraint_non_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.001_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.001_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.001_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_0.001_separate_theta_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.001_separate_theta_constraint_non_constraint
)
loglinear_loglinear_sigma_0.5_separate_theta_constraint_non_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.5_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.5_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.5_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_0.5_separate_theta_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.5_separate_theta_constraint_non_constraint
)

loglinear_loglinear_sigma_1_separate_theta_constraint_non_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_1_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_1_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_1_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_1_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_1_separate_theta_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_1_separate_theta_constraint_non_constraint
)

loglinear_loglinear_sigma_2_separate_theta_constraint_non_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_2_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_2_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_2_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_2_separate_theta_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_2_separate_theta_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_2_separate_theta_constraint_non_constraint
)

```


#### simultaneous

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_simultaneous_theta_constraint_non_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.001_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.001_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.001_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_0.001_simultaneous_theta_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.001_simultaneous_theta_constraint_non_constraint
)
loglinear_loglinear_sigma_0.5_simultaneous_theta_constraint_non_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.5_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.5_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.5_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_0.5_simultaneous_theta_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.5_simultaneous_theta_constraint_non_constraint
)

loglinear_loglinear_sigma_1_simultaneous_theta_constraint_non_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_1_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_1_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_1_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_1_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_1_simultaneous_theta_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_1_simultaneous_theta_constraint_non_constraint
)

loglinear_loglinear_sigma_2_simultaneous_theta_constraint_non_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_2_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_2_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_2_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_2_simultaneous_theta_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_2_simultaneous_theta_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_2_simultaneous_theta_constraint_non_constraint
)

```


#### mpec

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_mpec_non_constraint_theta_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.001_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.001_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.001_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1500_sigma_0.001_mpec_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.001_mpec_non_constraint_theta_constraint
)
loglinear_loglinear_sigma_0.5_mpec_non_constraint_theta_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.5_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_0.5_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_0.5_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1500_sigma_0.5_mpec_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.5_mpec_non_constraint_theta_constraint
)

loglinear_loglinear_sigma_1_mpec_non_constraint_theta_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_1_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_1_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_1_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_1_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1500_sigma_1_mpec_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_1_mpec_non_constraint_theta_constraint
)

loglinear_loglinear_sigma_2_mpec_non_constraint_theta_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_2_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_100_sigma_2_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_200_sigma_2_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1000_sigma_2_mpec_non_constraint_theta_constraint,
    loglinear_loglinear_n_1500_sigma_2_mpec_non_constraint_theta_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_2_mpec_non_constraint_theta_constraint
)

```

### theta_constraint_slope_constraint {.tabset}

#### separate

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_separate_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.001_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_0.001_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_0.001_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_0.001_separate_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.001_separate_theta_constraint_slope_constraint
)
loglinear_loglinear_sigma_0.5_separate_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.5_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_0.5_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_0.5_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_0.5_separate_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.5_separate_theta_constraint_slope_constraint
)

loglinear_loglinear_sigma_1_separate_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_1_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_1_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_1_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_1_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_1_separate_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_1_separate_theta_constraint_slope_constraint
)

loglinear_loglinear_sigma_2_separate_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_2_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_2_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_2_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_2_separate_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_2_separate_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_2_separate_theta_constraint_slope_constraint
)

```


#### simultaneous

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_simultaneous_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.001_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_0.001_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_0.001_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_0.001_simultaneous_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.001_simultaneous_theta_constraint_slope_constraint
)
loglinear_loglinear_sigma_0.5_simultaneous_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.5_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_0.5_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_0.5_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_0.5_simultaneous_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.5_simultaneous_theta_constraint_slope_constraint
)

loglinear_loglinear_sigma_1_simultaneous_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_1_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_1_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_1_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_1_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_1_simultaneous_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_1_simultaneous_theta_constraint_slope_constraint
)

loglinear_loglinear_sigma_2_simultaneous_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_2_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_2_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_2_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_2_simultaneous_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_2_simultaneous_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_2_simultaneous_theta_constraint_slope_constraint
)

```


#### mpec

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_mpec_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.001_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_0.001_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_0.001_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_0.001_mpec_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.001_mpec_theta_constraint_slope_constraint
)
loglinear_loglinear_sigma_0.5_mpec_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_0.5_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_0.5_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_0.5_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_0.5_mpec_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.5_mpec_theta_constraint_slope_constraint
)

loglinear_loglinear_sigma_1_mpec_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_1_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_1_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_1_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_1_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_1_mpec_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_1_mpec_theta_constraint_slope_constraint
)

loglinear_loglinear_sigma_2_mpec_theta_constraint_slope_constraint <-
  rbind(
    #loglinear_loglinear_n_50_sigma_2_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_100_sigma_2_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_200_sigma_2_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1000_sigma_2_mpec_theta_constraint_slope_constraint,
    loglinear_loglinear_n_1500_sigma_2_mpec_theta_constraint_slope_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_2_mpec_theta_constraint_slope_constraint
)




```

### non_constraint_non_constraint {.tabset}

<!-- #### separate -->

<!-- omit -->

```{r,echo=FALSE,results = "asis"}
# loglinear_loglinear_sigma_0.001_separate_non_constraint_non_constraint <-
#   rbind(
#     # loglinear_loglinear_n_50_sigma_0.001_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_100_sigma_0.001_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_200_sigma_0.001_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_1000_sigma_0.001_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_1500_sigma_0.001_separate_non_constraint_non_constraint)
# create_table_loglinear_with_demand_shifter_bias_rmse(
#   loglinear_loglinear_sigma_0.001_separate_non_constraint_non_constraint
# )
# loglinear_loglinear_sigma_0.5_separate_non_constraint_non_constraint <-
#   rbind(
#     # loglinear_loglinear_n_50_sigma_0.5_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_100_sigma_0.5_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_200_sigma_0.5_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_1000_sigma_0.5_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_1500_sigma_0.5_separate_non_constraint_non_constraint)
# create_table_loglinear_with_demand_shifter_bias_rmse(
#   loglinear_loglinear_sigma_0.5_separate_non_constraint_non_constraint
# )
# 
# loglinear_loglinear_sigma_1_separate_non_constraint_non_constraint <-
#   rbind(
#     # loglinear_loglinear_n_50_sigma_1_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_100_sigma_1_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_200_sigma_1_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_1000_sigma_1_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_1500_sigma_1_separate_non_constraint_non_constraint)
# create_table_loglinear_with_demand_shifter_bias_rmse(
#   loglinear_loglinear_sigma_1_separate_non_constraint_non_constraint
# )
# 
# loglinear_loglinear_sigma_2_separate_non_constraint_non_constraint <-
#   rbind(
#     # loglinear_loglinear_n_50_sigma_2_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_100_sigma_2_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_200_sigma_2_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_1000_sigma_2_separate_non_constraint_non_constraint,
#     loglinear_loglinear_n_1500_sigma_2_separate_non_constraint_non_constraint)
# create_table_loglinear_with_demand_shifter_bias_rmse(
#   loglinear_loglinear_sigma_2_separate_non_constraint_non_constraint
# )

```


#### simultaneous

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_simultaneous_non_constraint_non_constraint <-
  rbind(
    # loglinear_loglinear_n_50_sigma_0.001_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.001_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.001_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_0.001_simultaneous_non_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.001_simultaneous_non_constraint_non_constraint
)
loglinear_loglinear_sigma_0.5_simultaneous_non_constraint_non_constraint <-
  rbind(
    # loglinear_loglinear_n_50_sigma_0.5_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.5_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.5_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_0.5_simultaneous_non_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.5_simultaneous_non_constraint_non_constraint
)

loglinear_loglinear_sigma_1_simultaneous_non_constraint_non_constraint <-
  rbind(
    # loglinear_loglinear_n_50_sigma_1_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_1_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_1_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_1_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_1_simultaneous_non_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_1_simultaneous_non_constraint_non_constraint
)

loglinear_loglinear_sigma_2_simultaneous_non_constraint_non_constraint <-
  rbind(
    # loglinear_loglinear_n_50_sigma_2_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_2_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_2_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_2_simultaneous_non_constraint_non_constraint,
    loglinear_loglinear_n_1500_sigma_2_simultaneous_non_constraint_non_constraint)
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_2_simultaneous_non_constraint_non_constraint
)

```




#### mpec

```{r,echo=FALSE,results = "asis"}
loglinear_loglinear_sigma_0.001_mpec_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.001_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.001_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.001_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.001_mpec_non_constraint_non_constraint#,
    #loglinear_loglinear_n_1500_sigma_0.001_mpec_non_constraint_non_constraint
    )
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.001_mpec_non_constraint_non_constraint
)
loglinear_loglinear_sigma_0.5_mpec_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_0.5_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_0.5_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_0.5_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_0.5_mpec_non_constraint_non_constraint#,
    #loglinear_loglinear_n_1500_sigma_0.5_mpec_non_constraint_non_constraint
    )
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_0.5_mpec_non_constraint_non_constraint
)

loglinear_loglinear_sigma_1_mpec_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_1_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_1_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_1_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_1_mpec_non_constraint_non_constraint#,
    #loglinear_loglinear_n_1500_sigma_1_mpec_non_constraint_non_constraint
    )
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_1_mpec_non_constraint_non_constraint
)

loglinear_loglinear_sigma_2_mpec_non_constraint_non_constraint <-
  rbind(
    loglinear_loglinear_n_50_sigma_2_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_100_sigma_2_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_200_sigma_2_mpec_non_constraint_non_constraint,
    loglinear_loglinear_n_1000_sigma_2_mpec_non_constraint_non_constraint#,
    #loglinear_loglinear_n_1500_sigma_2_mpec_non_constraint_non_constraint
    )
create_table_loglinear_with_demand_shifter_bias_rmse(
  loglinear_loglinear_sigma_2_mpec_non_constraint_non_constraint
)

```


<!-- #### mpec separate -->

<!-- omit -->

<!-- ```{r,echo=FALSE,results = "asis"} -->
<!-- loglinear_loglinear_sigma_0.001_mpec_separate_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.001_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.001_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.001_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.001_mpec_separate_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.001_mpec_separate_theta_constraint_slope_constraint -->
<!-- ) -->
<!-- loglinear_loglinear_sigma_0.5_mpec_separate_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.5_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.5_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.5_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.5_mpec_separate_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.5_mpec_separate_theta_constraint_slope_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_1_mpec_separate_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_1_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_1_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_1_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_1_mpec_separate_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_1_mpec_separate_theta_constraint_slope_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_2_mpec_separate_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_2_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_2_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_2_mpec_separate_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_2_mpec_separate_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_2_mpec_separate_theta_constraint_slope_constraint -->
<!-- ) -->

<!-- ``` -->

<!-- #### optim_nelder_mead -->

<!-- omit -->

<!-- ```{r,echo=FALSE,results = "asis"} -->
<!-- loglinear_loglinear_sigma_0.001_optim_nelder_mead_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.001_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.001_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.001_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.001_optim_nelder_mead_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.001_optim_nelder_mead_theta_constraint_slope_constraint -->
<!-- ) -->
<!-- loglinear_loglinear_sigma_0.5_optim_nelder_mead_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.5_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.5_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.5_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.5_optim_nelder_mead_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.5_optim_nelder_mead_theta_constraint_slope_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_1_optim_nelder_mead_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_1_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_1_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_1_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_1_optim_nelder_mead_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_1_optim_nelder_mead_theta_constraint_slope_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_2_optim_nelder_mead_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_2_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_2_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_2_optim_nelder_mead_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_2_optim_nelder_mead_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_2_optim_nelder_mead_theta_constraint_slope_constraint -->
<!-- ) -->

<!-- ``` -->

<!-- ### log_constraint_theta_constraint {.tabset} -->

<!-- #### separate -->

<!-- ```{r,echo=FALSE,results = "asis"} -->
<!-- loglinear_loglinear_sigma_0.001_separate_log_constraint_theta_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.001_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.001_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.001_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.001_separate_log_constraint_theta_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.001_separate_log_constraint_theta_constraint -->
<!-- ) -->
<!-- loglinear_loglinear_sigma_0.5_separate_log_constraint_theta_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.5_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.5_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.5_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.5_separate_log_constraint_theta_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.5_separate_log_constraint_theta_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_1_separate_log_constraint_theta_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_1_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_1_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_1_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_1_separate_log_constraint_theta_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_1_separate_log_constraint_theta_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_2_separate_log_constraint_theta_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_2_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_2_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_2_separate_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_2_separate_log_constraint_theta_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_2_separate_log_constraint_theta_constraint -->
<!-- ) -->

<!-- ``` -->


<!-- #### simultaneous -->

<!-- ```{r,echo=FALSE,results = "asis"} -->
<!-- loglinear_loglinear_sigma_0.001_simultaneous_log_constraint_theta_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.001_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.001_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.001_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.001_simultaneous_log_constraint_theta_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.001_simultaneous_log_constraint_theta_constraint -->
<!-- ) -->
<!-- loglinear_loglinear_sigma_0.5_simultaneous_log_constraint_theta_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.5_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.5_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.5_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.5_simultaneous_log_constraint_theta_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.5_simultaneous_log_constraint_theta_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_1_simultaneous_log_constraint_theta_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_1_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_1_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_1_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_1_simultaneous_log_constraint_theta_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_1_simultaneous_log_constraint_theta_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_2_simultaneous_log_constraint_theta_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_2_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_2_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_2_simultaneous_log_constraint_theta_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_2_simultaneous_log_constraint_theta_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_2_simultaneous_log_constraint_theta_constraint -->
<!-- ) -->

<!-- ``` -->


<!-- #### mpec -->

<!-- ```{r,echo=FALSE,results = "asis"} -->
<!-- loglinear_loglinear_sigma_0.001_mpec_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.001_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.001_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.001_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.001_mpec_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.001_mpec_theta_constraint_slope_constraint -->
<!-- ) -->
<!-- loglinear_loglinear_sigma_0.5_mpec_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_0.5_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_0.5_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_0.5_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_0.5_mpec_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_0.5_mpec_theta_constraint_slope_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_1_mpec_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_1_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_1_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_1_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_1_mpec_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_1_mpec_theta_constraint_slope_constraint -->
<!-- ) -->

<!-- loglinear_loglinear_sigma_2_mpec_theta_constraint_slope_constraint <- -->
<!--   rbind( -->
<!--     loglinear_loglinear_n_50_sigma_2_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_100_sigma_2_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_200_sigma_2_mpec_theta_constraint_slope_constraint, -->
<!--     loglinear_loglinear_n_1000_sigma_2_mpec_theta_constraint_slope_constraint) -->
<!-- create_table_loglinear_with_demand_shifter_bias_rmse( -->
<!--   loglinear_loglinear_sigma_2_mpec_theta_constraint_slope_constraint -->
<!-- ) -->

<!-- ``` -->


## converged fraction of simultaneous vs mpec {.tabset}

```{r,echo=FALSE,results = "asis"}
#---------------------#
# compute fraction
#---------------------#
compute_converged_fraction <-
  function(
    target_simultaneous,
    target_mpec
    ){
    parameter_diff_tol <-
      1e-1
    obj_diff_tol <-
      1e-2
    classification_solved_indicator <-
      # no algorithm converged == 0
      # n2sls only converged == 1
      # mpec only converged == 2
      # mpec and n2sls converged == 3
      0 +
      (target_simultaneous[,10] == 1) * 1 +
      (target_mpec[,10] == 1) * 2
    classification_comparison_gmm_objective_value <-
      # same sol up to errors == 1
      # different sol, mpec and n2sls have the same obj value up to errors == 2
      # different sol, mpec has lower objective value than n2sls == 3 
      # different sol, n2sls has lower objective value than mpec == 4
      (rowSums(target_simultaneous[,1:9] - target_mpec[,1:9] < parameter_diff_tol) == 9) * 1 +
      (rowSums(target_simultaneous[,1:9] - target_mpec[,1:9] < parameter_diff_tol) < 9) *
      (abs(target_simultaneous[,13] - target_mpec[,13]) < obj_diff_tol) * 2 +
      (rowSums(target_simultaneous[,1:9] - target_mpec[,1:9] < parameter_diff_tol) < 9) *
      (abs(target_simultaneous[,13] - target_mpec[,13]) > obj_diff_tol) * 
      (target_simultaneous[,13] > target_mpec[,13]) * 3 +
      (rowSums(target_simultaneous[,1:9] - target_mpec[,1:9] < parameter_diff_tol) < 9) *
      (abs(target_simultaneous[,13] - target_mpec[,13]) > obj_diff_tol) * 
      (target_mpec[,13] > target_simultaneous[,13]) * 4
    classification_list <-
      cbind(
        classification_solved_indicator,
        classification_comparison_gmm_objective_value
      ) %>% 
      tibble::as_tibble() %>% 
      dplyr::mutate(
        classification =
          ifelse(
            classification_solved_indicator == 3,
            ifelse(
              classification_comparison_gmm_objective_value == 1,
              2 + 1,
              ifelse(
                classification_comparison_gmm_objective_value == 2,
                2 + 2,
                ifelse(
                  classification_comparison_gmm_objective_value == 3,
                  2 + 3,
                  2 + 4
                  )
                )
              ),
            classification_solved_indicator
            )
        ) %>% 
      dplyr::mutate(
        classification =
          dplyr::case_when(
            classification == 0 ~ "No algorithm converged",
            classification == 1 ~ "N2SLS only converged",
            classification == 2 ~ "MPEC only converged",
            classification == 3 ~ "Both converged, same sol",
            classification == 4 ~ "Both converged, different sol, same obj",
            classification == 5 ~ "Both converged, different sol, MPEC has lower obj",
            classification == 6 ~ "Both converged, different sol, N2SLS has lower obj"
            )
        ) %>% 
      dplyr::select(
        classification
      ) %>% 
      tidyr::drop_na()
    return(classification_list)
  }
# datasummary_skim(
#   res,
#   type = "categorical",
#   output = "table.tex"
#   )

```


### $T = 100$ {.tabset}

#### sigma = 0.5

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_100_sigma_0.5_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_100_sigma_0.5_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
```

#### sigma = 1.0

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_100_sigma_1_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_100_sigma_1_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
datasummary_skim(
  res,
  type = "categorical",
  title = "Fraction of convergence and smaller GMM objective value ($T=100,\\sigma=1.0$)",
  output = "../figuretable/fraction_convergence_and_objective_value_n_100_sigma_1.0_theta_constraint_slope_constraint.tex"
)
```

#### sigma = 2.0

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_100_sigma_2_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_100_sigma_2_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
```

### $T = 200$ {.tabset}

#### sigma = 0.5

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_200_sigma_0.5_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_200_sigma_0.5_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
```

#### sigma = 1.0

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_200_sigma_1_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_200_sigma_1_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
```

#### sigma = 2.0

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_200_sigma_2_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_200_sigma_2_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
```

### $T = 1000$ {.tabset}

#### sigma = 0.5

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_1000_sigma_0.5_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_1000_sigma_0.5_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
```

#### sigma = 1.0

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_1000_sigma_1_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_1000_sigma_1_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
```

#### sigma = 2.0

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_1000_sigma_2_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_1000_sigma_2_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
```

### $T = 1500$ {.tabset}

#### sigma = 0.5

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_1500_sigma_0.5_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_1500_sigma_0.5_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
```

#### sigma = 1.0

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_1500_sigma_1_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_1500_sigma_1_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
datasummary_skim(
  res,
  type = "categorical",
  title = "Fraction of convergence and smaller GMM objective value ($T=1500,\\sigma=1.0$)",
  output = "../figuretable/fraction_convergence_and_objective_value_n_1500_sigma_1.0_theta_constraint_slope_constraint.tex"
)
```

#### sigma = 2.0

```{r,echo=FALSE,results = "asis"}
res <-
  compute_converged_fraction(
    target_simultaneous =
      loglinear_loglinear_n_1500_sigma_2_simultaneous_theta_constraint_slope_constraint,
    target_mpec =
      loglinear_loglinear_n_1500_sigma_2_mpec_theta_constraint_slope_constraint
    )
datasummary_skim(
  res,
  type = "categorical"
)
```
